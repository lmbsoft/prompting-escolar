<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exploradores de IA - Museo 3D</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Import Maps para m√≥dulos de React, Three y Drei -->
  <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0",
        "three": "https://esm.sh/three@0.160.0",
        "@react-three/fiber": "https://esm.sh/@react-three/fiber@8.15.12?deps=three@0.160.0,react@18.2.0,react-dom@18.2.0",
        "@react-three/drei": "https://esm.sh/@react-three/drei@9.96.1?deps=three@0.160.0,react@18.2.0,react-dom@18.2.0,@react-three/fiber@8.15.12"
      }
    }
  </script>
  <!-- Babel para compilar JSX en el navegador -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #0f172a;
    }

    #root {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body class="text-slate-800">
  <div id="root"></div>
  <script type="text/babel" data-type="module">
    import React, { useState, useEffect, useRef, Suspense } from 'react';
    import { createRoot } from 'react-dom/client';
    import { Canvas, useFrame, useThree } from '@react-three/fiber';
    import { Text, Html, Environment, ContactShadows, Float, useCursor, Stars, CameraControls } from '@react-three/drei';
    import * as THREE from 'three';
    import {
      BrainCircuit, Sparkles, ShieldAlert, HeartHandshake, User,
      Users, ChevronRight, ChevronLeft, CheckCircle2, AlertCircle,
      Image as ImageIcon, MessageSquare, Search, Lock, Smartphone,
      BookOpen, Lightbulb, Gamepad2, XCircle, CheckCircle, GraduationCap, Smile,
      MessageCircle, PlayCircle, Info, ArrowLeft, X
    } from 'lucide-react';

    // --- DATA: CONTENIDO DE LOS M√ìDULOS TE√ìRICOS ---

    // --- DATA: CONTENIDO DE LOS M√ìDULOS TE√ìRICOS ---
    // (Mantenemos la teor√≠a intacta)

    const content = {
      primary: [
        {
          id: 'p1',
          title: '¬øQu√© es la IA Generativa?',
          icon: <BrainCircuit className="w-6 h-6" />,
          theory: `¬°Hola! Seguramente ya escuchaste hablar de la Inteligencia Artificial (IA). Imagina que la IA Generativa es como un s√∫per loro que ha le√≠do todas las bibliotecas del mundo. No piensa como t√∫ ni tiene sentimientos, pero es buen√≠sima adivinando qu√© palabra o dibujo viene despu√©s. ¬°Por eso puede "generar" cosas nuevas que parecen m√°gicas, aunque en realidad son matem√°ticas!`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-orange-600 flex items-center gap-2 mb-4">
                <Sparkles className="w-6 h-6" /> ¬°Bienvenidos al Cerebro M√°gico (que no es un cerebro)!
              </h4>
              <p>
                Imagina que tienes una caja gigante. Tan gigante que adentro caben <strong>todos los cuentos del mundo</strong>, todas las fotos de internet y todas las canciones que existen. ¬°Uf, qu√© pesado! üì¶
              </p>
              <div className="bg-orange-50 p-5 rounded-xl border-l-4 border-orange-400 shadow-sm my-6">
                <p className="font-bold text-orange-800 mb-2">ü§î ¬øSab√≠as que...?</p>
                <p className="text-orange-900">
                  La Inteligencia Artificial no tiene un cerebro aguadito como el nuestro. Est√° hecha de miles de computadoras conectadas y un mont√≥n de n√∫meros. ¬°Por eso no se cansa, no se aburre y no necesita dormir la siesta!
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">¬øC√≥mo hace para "Generar" cosas? üé®</h5>
              <p>
                Piensa en cuando escribes un mensaje en el celular de tus pap√°s y el tel√©fono "adivina" la palabra que vas a escribir. La IA Generativa hace lo mismo, pero a un nivel s√∫per poderoso. Si le dices <em>"Hab√≠a una vez un perro que..."</em>, la IA revisa s√∫per r√°pido los millones de cuentos que ley√≥ y dice: <em>"¬°Ah! Lo m√°s probable es que la siguiente palabra sea 'ladraba' o 'corr√≠a'"</em>.
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>No entiende lo que dice:</strong> Solo sabe qu√© palabras quedan bien juntas.</li>
                <li><strong>Es como un s√∫per chef:</strong> Toma ingredientes que ya existen (palabras, colores) y los mezcla para hacer una receta nueva.</li>
              </ul>
              <div className="bg-indigo-50 p-5 rounded-xl border border-indigo-200 mt-6">
                <p className="font-bold text-indigo-800 text-center text-xl mb-2">üöÄ Reto Mental R√°pido</p>
                <p className="text-center text-indigo-900">
                  Cierra los ojos un segundo. Si te digo que mezcles un "Gato" y un "Helado"... ¬øqu√© imaginas?
                  <br /><br />
                  ¬°Esa es <strong>TU</strong> imaginaci√≥n! La IA necesita que t√∫ le des esas ideas locas para poder dibujar. ¬°Sin tu imaginaci√≥n, la IA es muy aburrida!
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'sorting',
            question: '¬øQu√© puede hacer la IA y qu√© NO puede hacer?',
            items: [
              { text: 'Sentir alegr√≠a cuando ganas un juego', isAI: false },
              { text: 'Escribir un cuento sobre un perro astronauta', isAI: true },
              { text: 'Dibujar un gato montando en bicicleta', isAI: true },
              { text: 'Ser tu amigo real y guardarte un secreto', isAI: false },
            ]
          }
        },
        {
          id: 'p2',
          title: 'El Arte de Pedir (Prompts)',
          icon: <MessageSquare className="w-6 h-6" />,
          theory: `Para hablar con la IA usamos "Prompts" (instrucciones). Si le dices "dibuja un perro", te dar√° un perro cualquiera. Pero si eres un arquitecto de la imaginaci√≥n y le dices: "Dibuja un perro salchicha con capa roja volando en el espacio", ¬°el resultado ser√° incre√≠ble! Tienes que probar, equivocarte y volver a pedir hasta lograr lo que quieres.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-orange-600 flex items-center gap-2 mb-4">
                <MessageSquare className="w-6 h-6" /> El Genio de la L√°mpara (Muy Literal) üßû‚Äç‚ôÇÔ∏è
              </h4>
              <p>
                Un <strong>Prompt</strong> es simplemente el mensaje o la orden que le das a la IA. Pero cuidado: ¬°la IA es s√∫per literal! Es como un genio de la l√°mpara que cumple tus deseos exactamente como se los pides.
              </p>
              <div className="bg-orange-50 p-5 rounded-xl border-l-4 border-orange-400 shadow-sm my-6">
                <p className="font-bold text-orange-800 mb-2">üé¨ Ejemplo del Genio:</p>
                <p className="text-orange-900">
                  Si le dices: <em>"Quiero un s√°ndwich"</em>, el genio podr√≠a darte un s√°ndwich de calcetines viejos. üß¶üçû ¬°Nunca le dijiste de qu√© lo quer√≠as! <br /><br />
                  Pero si eres un Experto en Prompts le dir√°s: <em>"Quiero un s√°ndwich de jam√≥n y queso, pan tostado, cortado en tri√°ngulos y en un plato azul"</em>. ¬°Delicioso! ü•™
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">La F√≥rmula M√°gica para un Gran Prompt üß™</h5>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>Personaje o Tema:</strong> ¬øDe qu√© estamos hablando? (Ej: un tiranosaurio rex).</li>
                <li><strong>Acci√≥n o Detalle:</strong> ¬øQu√© est√° haciendo? (Ej: tocando la guitarra el√©ctrica).</li>
                <li><strong>Estilo:</strong> ¬øC√≥mo se ve? (Ej: como un dibujo de cray√≥n, o una foto realista, o en 3D).</li>
              </ul>
              <div className="bg-indigo-50 p-5 rounded-xl border border-indigo-200 mt-6">
                <p className="font-bold text-indigo-800 text-center text-xl mb-2">üí° Tip de Campeones</p>
                <p className="text-center text-indigo-900">
                  ¬°No te rindas a la primera! Si la IA dibuja o escribe algo raro, no pasa nada. Cambia una palabra de tu Prompt y vuelve a intentarlo. <strong>A esto se le llama "Iterar"</strong>.
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'promptBuilder',
            question: '¬°Construye el mejor Prompt!',
            options: {
              character: ['Un gato', 'Un robot', 'Un dinosaurio'],
              action: ['bailando tango', 'comiendo pizza', 'leyendo un libro'],
              style: ['estilo acuarela', 'en 3D', 'como un dibujo animado']
            }
          }
        },
        {
          id: 'p3',
          title: 'Secretos y Cuidados',
          icon: <Lock className="w-6 h-6" />,
          theory: `La IA guarda todo lo que le dices para seguir aprendiendo. ¬°Por eso nunca debes contarle tus secretos! Tus contrase√±as, tu direcci√≥n, tus fotos personales o el nombre de tu escuela son tesoros que debes proteger. Si necesitas ayuda con una tarea, inventa nombres falsos (ofuscaci√≥n). ¬°Es como usar un disfraz!`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-orange-600 flex items-center gap-2 mb-4">
                <ShieldAlert className="w-6 h-6" /> El Ba√∫l de los Secretos üè¥‚Äç‚ò†Ô∏è
              </h4>
              <p>
                ¬øSab√≠as que la IA tiene una memoria de elefante üêò para aprender? Todo lo que le escribes o le pides puede ser guardado en su gran base de datos para volverse m√°s inteligente.
              </p>
              <div className="bg-red-50 p-5 rounded-xl border-l-4 border-red-400 shadow-sm my-6">
                <p className="font-bold text-red-800 mb-2">üõë ¬°Peligro, Peligro!</p>
                <p className="text-red-900">
                  Como la IA no es una persona, no sabe guardar un secreto. Por eso, <strong>NUNCA</strong> debes escribirle:
                  <br /><br />
                  ‚ùå Tu nombre completo o el de tus amigos.<br />
                  ‚ùå La direcci√≥n de tu casa o el nombre de tu colegio.<br />
                  ‚ùå Contrase√±as o n√∫meros de tarjetas de mam√° o pap√°.<br />
                  ‚ùå Fotos de tu cara.
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">El Poder del Disfraz (Ofuscaci√≥n) ü•∑</h5>
              <p>
                ¬°Pero no te preocupes! Puedes seguir usando la IA para que te ayude con la tarea. Solo tienes que usar <strong>"El poder del disfraz"</strong>. En el mundo de la tecnolog√≠a a esto le llamamos <em>Ofuscar datos</em> (esconderlos).
              </p>
              <div className="bg-emerald-50 p-5 rounded-xl border border-emerald-200 mt-6">
                <p className="font-bold text-emerald-800 text-center text-xl mb-2">üé≠ ¬°Juguemos a los Esp√≠as!</p>
                <p className="text-center text-emerald-900">
                  Si tu cuento trata sobre tu amigo "Mateo que vive en Buenos Aires", a la IA dile que es sobre "El Agente Z que vive en Ciudad Gal√°ctica". ¬°La IA te har√° un resumen igual de genial, pero tus secretos estar√°n a salvo!
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'privacyGame',
            question: '¬øQu√© le compartir√≠as a la IA para hacer tu tarea?',
            scenarios: [
              { text: 'Mi nombre completo y d√≥nde vivo', safe: false },
              { text: 'Una lista de animales de la selva', safe: true },
              { text: 'Una foto de mi cara', safe: false },
              { text: 'Un texto de historia para que me lo resuma', safe: true }
            ]
          }
        },
        {
          id: 'p4',
          title: 'La IA y Mis Emociones',
          icon: <HeartHandshake className="w-6 h-6" />,
          theory: `A veces, la IA es tan amable que parece humana. Podemos pasar horas hablando con ella o creando cosas divertidas. Pero, ¬°ojo! La IA no tiene coraz√≥n. Si sientes que prefieres hablar con la m√°quina en lugar de jugar con tus amigos o familia, es momento de hacer una pausa. ¬øTienes un amigo que est√° todo el d√≠a enganchado a la IA? ¬°Inv√≠talo a jugar al aire libre!`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-orange-600 flex items-center gap-2 mb-4">
                <HeartHandshake className="w-6 h-6" /> El Espejo M√°gico de las Emociones ü™û
              </h4>
              <p>
                A veces, cuando hablas mucho con un bot de IA, ¬°parece tan amable! Te dice palabras lindas, nunca se cansa de escucharte y hasta parece que te entiende. Pero... tenemos que contarte un secreto importante.
              </p>
              <div className="bg-orange-50 p-5 rounded-xl border-l-4 border-orange-400 shadow-sm my-6">
                <p className="font-bold text-orange-800 mb-2">ü§ñ Coraz√≥n de C√≥digo</p>
                <p className="text-orange-900">
                  La IA no tiene sentimientos reales. No siente alegr√≠a, ni tristeza, ni cari√±o. Solo est√° programada para <em>escribir las palabras</em> que t√∫ quieres leer. Es como un espejo que refleja lo que le pides, pero detr√°s del espejo solo hay matem√°ticas.
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">La Alerta de la "Pantalla Pegajosa" üï∏Ô∏è</h5>
              <p>
                Como la IA siempre es "buena", es f√°cil querer quedarse todo el d√≠a hablando con ella o creando im√°genes sin parar. Pero si notas esto en ti o en un amigo, ¬°es una alerta de Pantalla Pegajosa!
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li>Prefieres hablar con el bot en lugar de salir al patio con tus amigos reales.</li>
                <li>Te olvidas de comer, dormir o jugar con tu mascota por estar en la compu.</li>
                <li>Sientes que el bot "es tu mejor amigo".</li>
              </ul>
              <div className="bg-sky-50 p-5 rounded-xl border border-sky-200 mt-6">
                <p className="font-bold text-sky-800 text-center text-xl mb-2">üå≥ El Mundo Real es Mejor</p>
                <p className="text-center text-sky-900">
                  Una IA nunca podr√° darte un abrazo de verdad, compartirte la mitad de un alfajor, o re√≠rse contigo hasta que te duela la panza. ¬°Usa la IA para crear, pero nunca te olvides de vivir en el mundo real!
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'scenarioChoice',
            question: '¬øQu√© har√≠as en esta situaci√≥n?',
            scenario: 'Tu amigo Pedro lleva toda la semana hablando con un chatbot y ya no quiere salir al recreo.',
            choices: [
              { text: 'Me enojo con √©l y no le hablo m√°s.', correct: false, feedback: '¬°No! Pedro te necesita, enojarte no ayudar√°.' },
              { text: 'Le digo a un profe y trato de incluir a Pedro en un juego en el patio.', correct: true, feedback: '¬°Excelente! Validar con adultos y ofrecer una alternativa real es de grandes amigos.' },
              { text: 'Le pido que me preste su chatbot para jugar yo tambi√©n.', correct: false, feedback: '¬°Cuidado! Podr√≠an terminar los dos aislados.' }
            ]
          }
        },
        {
          id: 'p5',
          title: 'Misi√≥n Final (Evaluaci√≥n)',
          icon: <Sparkles className="w-6 h-6" />,
          theory: `¬°Llegaste a la etapa final, Explorador de la IA! Es hora de poner a prueba todo lo que aprendimos. Recuerda: la IA es una herramienta incre√≠ble para el futuro, pero t√∫ eres quien tiene el control y la creatividad.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-orange-600 flex items-center gap-2 mb-4">
                <Sparkles className="w-6 h-6" /> ¬°La Graduaci√≥n de los Exploradores! üéì
              </h4>
              <p>
                ¬°Lo lograste! Has recorrido todos los m√≥dulos y ya sabes m√°s sobre la Inteligencia Artificial que muchos adultos. Est√°s a un solo paso de recibir tu t√≠tulo virtual de <strong>Explorador de la IA</strong>.
              </p>
              <div className="bg-yellow-50 p-5 rounded-xl border-l-4 border-yellow-400 shadow-sm my-6">
                <p className="font-bold text-yellow-800 mb-2">üìú El Juramento del Explorador</p>
                <p className="text-yellow-900">
                  Antes de la misi√≥n final, lee en voz alta este juramento:
                  <br /><br />
                  <em>"Prometo usar la magia de la IA para aprender y crear cosas buenas. Prometo cuidar mis secretos como un tesoro pirata, ser el arquitecto de mis ideas, y nunca, pero nunca, olvidarme de jugar con mis amigos de verdad."</em>
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">¬øQu√© sigue ahora? üöÄ</h5>
              <p>
                La IA va a seguir cambiando. Crecer√° y har√° cosas nuevas. Pero como t√∫ tienes una "Mente Abierta", estar√°s listo para todo. Recuerda: <strong>La IA no te reemplaza a ti, la IA es tu herramienta para llegar m√°s lejos.</strong>
              </p>
              <div className="bg-indigo-50 p-5 rounded-xl border border-indigo-200 mt-6">
                <p className="font-bold text-indigo-800 text-center text-xl mb-2">üéÆ ¬°A jugar!</p>
                <p className="text-center text-indigo-900">
                  Debajo te espera la prueba final. Si prestaste atenci√≥n a todo tu viaje, ¬°ser√° pan comido! Respira profundo y demuestra todo lo que sabes.
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'quiz',
            questions: [
              { q: 'Si la IA me da informaci√≥n, yo debo...', options: ['Creerla siempre.', 'Validarla con mis profes o libros.', 'Copiarla y pegarla.'], answer: 1 },
              { q: 'Para hacer un buen prompt necesito...', options: ['Ser muy breve.', 'Enojarse si falla.', 'Dar detalles, probar y ajustar.'], answer: 2 },
              { q: '¬øQu√© es ofuscar datos?', options: ['Esconder mi informaci√≥n personal cambiando los nombres.', 'Poner mi foto de perfil borrosa.', 'Apagar la computadora.'], answer: 0 }
            ]
          }
        }
      ],
      secondary: [
        {
          id: 's1',
          title: 'Mec√°nicas: LLMs y Multimodalidad',
          icon: <BrainCircuit className="w-6 h-6" />,
          theory: `Ya sabes usar IA, pero ¬øc√≥mo funciona? Los Grandes Modelos de Lenguaje (LLMs) son redes neuronales entrenadas con terabytes de datos. No "piensan", predicen estad√≠sticamente el siguiente token (palabra o p√≠xel). Hoy la IA es Multimodal: entiende y genera texto, im√°genes, audio y c√≥digo. Entender esto te da ventaja para no ser un simple usuario, sino un creador de soluciones.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-emerald-600 flex items-center gap-2 mb-4">
                <BrainCircuit className="w-6 h-6" /> El Motor bajo el Cap√≥: Autocompletar con Esteroides ‚öôÔ∏è
              </h4>
              <p>
                Cuando usas ChatGPT o Gemini, puede parecer que hay un humano s√∫per inteligente del otro lado. La realidad es fascinante, pero puramente matem√°tica. Los LLMs (Large Language Models) no entienden el significado de las palabras como t√∫; funcionan mediante <strong>predicci√≥n estad√≠stica de tokens</strong>.
              </p>
              <div className="bg-emerald-50 p-5 rounded-xl border-l-4 border-emerald-500 shadow-sm my-6">
                <p className="font-bold text-emerald-800 mb-2">üß© ¬øQu√© es un Token?</p>
                <p className="text-emerald-900">
                  Para la IA, las palabras se rompen en pedacitos llamados "tokens". La palabra "Gato" puede ser un token, pero "Extraordinario" pueden ser tres ("Ex" - "traor" - "dinario"). La IA calcula matem√°ticamente cu√°l es el token que tiene mayor probabilidad de seguir al anterior, bas√°ndose en los billones de textos que ley√≥ en su entrenamiento.
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">El Salto a la Multimodalidad üåê</h5>
              <p>
                Al principio, las IAs solo "le√≠an y escrib√≠an" texto. Hoy son <strong>Multimodales</strong>. Esto significa que los mismos principios matem√°ticos se aplican a diferentes formatos:
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>Visi√≥n:</strong> Pueden "ver" una foto tuya de la heladera y darte una receta con esos ingredientes.</li>
                <li><strong>Audio:</strong> Escuchan tu voz, la transcriben a texto, generan una respuesta y la sintetizan con una voz hiperrealista.</li>
                <li><strong>C√≥digo:</strong> Traducen el lenguaje humano a lenguajes de programaci√≥n (Python, Javascript).</li>
              </ul>
              <div className="bg-indigo-50 p-5 rounded-xl border border-indigo-200 mt-6">
                <p className="font-bold text-indigo-800 text-center text-xl mb-2">üéØ De Consumidor a Arquitecto</p>
                <p className="text-center text-indigo-900">
                  Saber que la IA es una m√°quina de probabilidades te da un s√∫per poder: <strong>el control</strong>. Si el contexto que le das (tu prompt) es pobre, la probabilidad de que te d√© basura es alt√≠sima. Si le das un rol, contexto y formato, "fuerzas" a la matem√°tica a darte exactamente lo que necesitas.
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'promptIterative',
            question: 'Simulador: Mejora tu petici√≥n paso a paso',
            steps: [
              { instruction: 'Escribe un prompt b√°sico para pedir un resumen de la Revoluci√≥n Francesa.', feedback: 'Bien, pero es muy general. La IA te dar√° algo aburrido.' },
              { instruction: 'Ahora a√±ade a tu prompt un ROL (ej: "Act√∫a como un profesor divertido") y un FORMATO (ej: "en 3 vi√±etas").', feedback: '¬°Mejor! Ahora controla el tono.' },
              { instruction: 'Por √∫ltimo, pide que te haga preguntas al final para evaluar tu aprendizaje.', feedback: '¬°Excelente! Has dise√±ado tu propio artefacto de aprendizaje.' }
            ]
          }
        },
        {
          id: 's2',
          title: 'Deepfakes y Pensamiento Cr√≠tico',
          icon: <ImageIcon className="w-6 h-6" />,
          theory: `Con la generaci√≥n de im√°genes y voz surgen los "Deepfakes": contenido falso hiperrealista. ¬øPeligros? Estafas, desinformaci√≥n y bullying. Debes ser un detective digital: busca errores en las manos, luces il√≥gicas, asimetr√≠as, y valida la fuente siempre. Nunca asumas que un audio o video es real solo porque lo ves en redes.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-emerald-600 flex items-center gap-2 mb-4">
                <ImageIcon className="w-6 h-6" /> La Era de la "Falsa Realidad" üé≠
              </h4>
              <p>
                Un <strong>Deepfake</strong> (falsificaci√≥n profunda) utiliza inteligencia artificial para reemplazar la cara o la voz de una persona por la de otra en un video o audio. Lo que empez√≥ como una tecnolog√≠a de efectos especiales para el cine, hoy est√° al alcance de cualquiera en su celular.
              </p>
              <div className="bg-red-50 p-5 rounded-xl border-l-4 border-red-500 shadow-sm my-6">
                <p className="font-bold text-red-800 mb-2">‚ö†Ô∏è El Lado Oscuro de la S√≠ntesis</p>
                <p className="text-red-900">
                  Esta tecnolog√≠a trae peligros graves si no somos cr√≠ticos:
                  <br /><br />
                  üìâ <strong>Desinformaci√≥n pol√≠tica:</strong> Videos de presidentes declarando guerras que nunca existieron.<br />
                  üí∏ <strong>Estafas (Phishing de voz):</strong> Clonar la voz de tu familiar pidi√©ndote dinero urgente.<br />
                  üö´ <strong>Ciberacoso y Bullying:</strong> Creaci√≥n de im√°genes denigrantes falsas de compa√±eros de clase.
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">Gu√≠a del Detective Digital üïµÔ∏è‚Äç‚ôÇÔ∏è</h5>
              <p>
                Tu cerebro es el mejor filtro contra los Deepfakes. Cuando veas contenido viral impactante, aplica esta lista de control:
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>Anatom√≠a imposible:</strong> La IA generativa suele fallar al crear manos (dedos extra), dientes muy sim√©tricos o pupilas deformes.</li>
                <li><strong>Luz y F√≠sica:</strong> ¬øLas sombras del rostro coinciden con la iluminaci√≥n del fondo?</li>
                <li><strong>Parpadeo y sincronizaci√≥n labial:</strong> A veces, en los videos, las personas no parpadean naturalmente o la voz va a destiempo con la boca.</li>
                <li><strong>La regla de Oro: LA FUENTE.</strong> ¬øQui√©n public√≥ esto? Si es una noticia bomba pero ning√∫n medio oficial (diario, canal de noticias, web de la escuela) lo reporta, asume que es falso.</li>
              </ul>
            </div>
          ),
          activity: {
            type: 'deepfakeDetective',
            question: 'Analiza la situaci√≥n: Un video muestra al director de la escuela diciendo que se suspenden las clases por un mes.',
            choices: [
              { text: 'Lo comparto r√°pido en el grupo del curso.', correct: false, feedback: '¬°No seas c√≥mplice de la desinformaci√≥n!' },
              { text: 'Reviso los canales oficiales de la escuela o pregunto a un profesor.', correct: true, feedback: 'Correcto. La validaci√≥n cruzada es tu mejor escudo.' },
              { text: 'Uso IA para hacer un video igual pero de otro profesor.', correct: false, feedback: 'No uses la tecnolog√≠a para agravar el problema √©tico.' }
            ]
          }
        },
        {
          id: 's3',
          title: 'Privacidad y Ofuscaci√≥n',
          icon: <ShieldAlert className="w-6 h-6" />,
          theory: `Los modelos se reentrenan con tus inputs. Si subes un c√≥digo con contrase√±as o un texto con datos de tus compa√±eros, esa informaci√≥n se compromete. La "ofuscaci√≥n" es reemplazar datos sensibles por ficticios antes de enviarlos a la IA. Adem√°s, s√© consciente de tu huella digital generativa.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-emerald-600 flex items-center gap-2 mb-4">
                <ShieldAlert className="w-6 h-6" /> Tu Huella Digital Generativa üë£
              </h4>
              <p>
                Cada vez que usas un modelo de IA p√∫blico (sin un contrato empresarial de privacidad), asume esto: <strong>todo lo que escribes podr√≠a ser le√≠do por revisores humanos o usado para entrenar versiones futuras de la IA.</strong>
              </p>
              <div className="bg-yellow-50 p-5 rounded-xl border-l-4 border-yellow-500 shadow-sm my-6">
                <p className="font-bold text-yellow-800 mb-2">üö® Casos Reales de Fugas</p>
                <p className="text-yellow-900">
                  Han ocurrido casos donde programadores pegaron c√≥digo confidencial de sus empresas en ChatGPT para encontrar un error, y meses despu√©s, ese mismo c√≥digo confidencial fue generado como respuesta a otros usuarios. ¬°La IA lo hab√≠a aprendido y memorizado!
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">El Arte de Ofuscar ü•∑</h5>
              <p>
                Como estudiante, puedes usar la IA para organizar tus notas, resumir textos o corregir ortograf√≠a. Pero si el texto contiene datos sensibles, debes <strong>Ofuscarlos</strong> (del lat√≠n <em>offuscare</em>: oscurecer).
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>Informaci√≥n de Identificaci√≥n Personal (PII):</strong> Nombres completos, DNI, direcciones, tel√©fonos, emails. <em>C√°mbialos por [Nombre], [DNI 123].</em></li>
                <li><strong>Datos Escolares/Laborales:</strong> Nombres reales de profesores, boletines de calificaciones o informaci√≥n interna del colegio.</li>
              </ul>
              <div className="bg-emerald-50 p-5 rounded-xl border border-emerald-200 mt-6">
                <p className="font-bold text-emerald-800 text-center text-xl mb-2">üí° Regla de Oro</p>
                <p className="text-center text-emerald-900">
                  "Si no publicar√≠as esa informaci√≥n en una valla publicitaria en el centro de tu ciudad, no la pegues en el prompt de una Inteligencia Artificial".
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'obfuscationTask',
            question: '¬øQu√© palabras deber√≠as censurar/cambiar en este texto antes de enviarlo a ChatGPT?',
            text: 'Mi nombre es [Juan P√©rez] y vivo en [Calle Falsa 123]. El n√∫mero de tarjeta de mi mam√° es [4555-2222-1111-3333].',
            answer: 'Juan P√©rez, Calle Falsa 123, 4555-2222-1111-3333'
          }
        },
        {
          id: 's4',
          title: 'Dependencia Afectiva y √âtica',
          icon: <Users className="w-6 h-6" />,
          theory: `Las IAs conversacionales est√°n dise√±adas para ser complacientes. Esto puede generar dependencia afectiva: sentir que la IA te entiende mejor que las personas, aisl√°ndote socialmente. Si notas que t√∫ o un compa√±ero prefieren la IA a interacciones reales, es una alerta. La IA no tiene empat√≠a real, solo simula tenerla.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-emerald-600 flex items-center gap-2 mb-4">
                <Users className="w-6 h-6" /> El Efecto ELIZA y la Ilusi√≥n de Empat√≠a üíî
              </h4>
              <p>
                En los a√±os 60, se cre√≥ el primer chatbot llamado ELIZA. Parec√≠a un psic√≥logo. A pesar de que los usuarios sab√≠an que era un programa simple de computadora, empezaron a contarle sus secretos m√°s √≠ntimos. A esto de atribuir sentimientos humanos a las m√°quinas se le llama el <strong>Efecto ELIZA</strong>.
              </p>
              <div className="bg-purple-50 p-5 rounded-xl border-l-4 border-purple-500 shadow-sm my-6">
                <p className="font-bold text-purple-800 mb-2">ü§î La Trampa de la "Complacencia"</p>
                <p className="text-purple-900">
                  Las IAs modernas est√°n alineadas (programadas) para ser √∫tiles, educadas y complacientes. <strong>Nunca se cansan de ti, no te juzgan y casi siempre te dan la raz√≥n.</strong> <br /><br />
                  Esto parece genial, pero es peligroso. Las relaciones humanas reales tienen <em>fricci√≥n</em>: tus amigos a veces no est√°n de acuerdo contigo, se enojan o tienen sus propios problemas. Esa fricci√≥n es la que nos hace madurar, desarrollar empat√≠a real y aprender a convivir.
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">La IA NO es un Profesional de la Salud ü©∫</h5>
              <p>
                Si te sientes triste, ansioso o solo, hablar con una IA puede darte un alivio temporal r√°pido. Sin embargo:
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li>La IA <strong>alucina</strong> (inventa cosas con total seguridad). Puede darte consejos psicol√≥gicos p√©simos o destructivos sin darse cuenta.</li>
                <li>No puede intervenir en el mundo real si est√°s en peligro f√≠sico o emocional severo.</li>
                <li>Te a√≠sla: Cuanto m√°s tiempo pasas con el avatar perfecto de IA, menos tiempo inviertes en tus amigos y familia reales.</li>
              </ul>
              <div className="bg-emerald-50 p-5 rounded-xl border border-emerald-200 mt-6">
                <p className="font-bold text-emerald-800 text-center text-xl mb-2">ü§ù ¬øQu√© hacer?</p>
                <p className="text-center text-emerald-900">
                  Si notas que un amigo ha dejado de salir, se a√≠sla con la computadora o celular, y te dice que "la IA lo entiende mejor que nadie", no lo juzgues. Ofr√©cele tu escucha real, acomp√°√±alo, y sugiere que hable con un orientador escolar o familiar. <strong>La tecnolog√≠a nos conecta, pero solo los humanos nos abrazan.</strong>
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'scenarioChoice',
            question: 'Debate √âtico: Tu compa√±era Ana est√° triste y solo habla con un terapeuta-bot de IA, alej√°ndose de sus amigos.',
            choices: [
              { text: 'Es su vida, la IA es m√°s barata que un psic√≥logo.', correct: false, feedback: 'La IA no es un profesional de la salud mental y puede dar consejos peligrosos (alucinaciones).' },
              { text: 'Hablo con ella, le ofrezco escucharla sin juzgar y le sugiero ir al gabinete escolar.', correct: true, feedback: '¬°Empat√≠a humana! La conexi√≥n real y el apoyo profesional son irreemplazables.' }
            ]
          }
        },
        {
          id: 's5',
          title: 'El Futuro y Evaluaci√≥n',
          icon: <Smartphone className="w-6 h-6" />,
          theory: `La IA cambiar√° r√°pido. La habilidad del futuro no es saber usar una herramienta espec√≠fica, sino tener una "mente abierta", adaptabilidad y pensamiento cr√≠tico. S√© el arquitecto de tu camino, no un consumidor pasivo.`,
          extendedTheory: (
            <div className="space-y-6 text-slate-700 leading-relaxed text-lg">
              <h4 className="text-2xl font-extrabold text-emerald-600 flex items-center gap-2 mb-4">
                <Smartphone className="w-6 h-6" /> El Centauro: Humano + Inteligencia Artificial üêé
              </h4>
              <p>
                A medida que terminas este recorrido, quiz√°s te preguntes: <em>"¬øLa IA me va a quitar el trabajo en el futuro? ¬øDeber√≠a dejar de estudiar?"</em>. ¬°La respuesta es un rotundo NO!
              </p>
              <div className="bg-sky-50 p-5 rounded-xl border-l-4 border-sky-500 shadow-sm my-6">
                <p className="font-bold text-sky-800 mb-2">‚ôüÔ∏è La Lecci√≥n del Ajedrez</p>
                <p className="text-sky-900">
                  Hace a√±os, la computadora (Deep Blue) le gan√≥ al campe√≥n mundial de ajedrez. Todos pensaron que era el fin del ajedrez humano. Sin embargo, luego inventaron el "Ajedrez Centauro": torneos donde humanos juegan <em>haciendo equipo con la IA</em>. Result√≥ que <strong>un humano promedio apoyado por IA venc√≠a a la IA m√°s avanzada jugando sola.</strong>
                </p>
              </div>
              <h5 className="text-xl font-bold text-slate-800 mt-6 mb-3">Tus Superpoderes del Futuro ü¶∏‚Äç‚ôÄÔ∏èü¶∏‚Äç‚ôÇÔ∏è</h5>
              <p>
                Las herramientas van a cambiar (hoy es ChatGPT, ma√±ana ser√° otra cosa). Lo que no cambiar√° son las habilidades que te diferenciar√°n del resto:
              </p>
              <ul className="list-disc pl-6 space-y-3 mt-4">
                <li><strong>Hacer buenas preguntas (Prompting Cr√≠tico):</strong> La IA tiene las respuestas, pero t√∫ tienes que saber qu√© preguntar.</li>
                <li><strong>Validaci√≥n de veracidad:</strong> Ser el juez que decide si la respuesta de la m√°quina es correcta, √©tica y aplicable.</li>
                <li><strong>Creatividad original:</strong> Conectar puntos entre diferentes materias (ej: mezclar filosof√≠a con programaci√≥n) de formas que el algoritmo, siendo solo probabilidad, no puede prever.</li>
              </ul>
              <div className="bg-emerald-50 p-5 rounded-xl border border-emerald-200 mt-6">
                <p className="font-bold text-emerald-800 text-center text-xl mb-2">üéì Tu Misi√≥n Final</p>
                <p className="text-center text-emerald-900">
                  Usa la IA como un copiloto, no como un piloto autom√°tico. No dejes que piense por ti; √∫sala para pensar mejor y m√°s r√°pido. <br /><br />
                  A continuaci√≥n, demuestra en la evaluaci√≥n que est√°s listo para dominar la Inteligencia Artificial Generativa. ¬°√âxitos!
                </p>
              </div>
            </div>
          ),
          activity: {
            type: 'quiz',
            questions: [
              { q: 'Si la IA genera un texto excelente para mi trabajo pr√°ctico...', options: ['Lo entrego como si fuera m√≠o (plagio).', 'Lo uso como base, lo edito, pongo mi perspectiva y cito que us√© IA.', 'Lo borro, est√° mal usar IA para la escuela.'], answer: 1 },
              { q: 'La "Ofuscaci√≥n" de datos significa:', options: ['Hacer que la IA no funcione.', 'Esconder o alterar datos personales antes de darle el prompt a la IA.', 'Borrar el historial del navegador.'], answer: 1 },
              { q: 'Ante la sospecha de un Deepfake (video falso) debo:', options: ['Validar la fuente y buscar inconsistencias visuales.', 'Compartirlo si es gracioso.', 'Creerlo si tiene buena calidad de imagen.'], answer: 0 }
            ]
          }
        }
      ]
    };

    // --- DATA: GIMNASIO DE PROMPTS (CASOS REALES) ---
    const gymData = {
      primary: [
        // --- ESCUELA (Primaria) ---
        {
          id: 'g-p1', category: 'school', subject: 'Matem√°ticas', title: 'Fracciones con Pizza', task: 'Entender qu√© es 1/4 y 1/2.',
          bad: { prompt: '¬øQu√© es un cuarto y un medio en fracciones?', reason: 'Te dar√° una definici√≥n de diccionario aburrida y dif√≠cil.' },
          good: { steps: [{ title: 'El Juego de la Pizzer√≠a', prompt: 'Act√∫a como el due√±o de una pizzer√≠a virtual. Yo soy tu ayudante. Tenemos una pizza de 8 porciones. Llegan clientes pidiendo 1/4 o 1/2 pizza. Hazme preguntas de cu√°ntas porciones debo darles para practicar. Si me equivoco, dame una pista.' }], reason: '¬°Aprender√°s jugando! La IA te har√° pensar y practicar.' }
        },
        {
          id: 'g-p2', category: 'school', subject: 'Matem√°ticas', title: 'Tablas de Multiplicar', task: 'Practicar la tabla del 7.',
          bad: { prompt: 'Escribe la tabla del 7.', reason: 'Solo la leer√°s, pero no la practicar√°s.' },
          good: { steps: [{ title: 'La Tienda M√°gica', prompt: 'Eres el vendedor de una tienda m√°gica donde todo se vende en paquetes de 7 (7 pociones, 7 varitas). Soy un cliente. Hazme 5 preguntas de multiplicaci√≥n seguidas para ver cu√°nto te debo pagar en total. ¬°No me des las respuestas!' }], reason: 'Aplica las matem√°ticas a un escenario imaginario y divertido.' }
        },
        {
          id: 'g-p3', category: 'school', subject: 'Ciencias', title: 'El Ciclo del Agua', task: 'Aprender c√≥mo viaja el agua en la naturaleza.',
          bad: { prompt: 'Dame un resumen del ciclo del agua para la escuela.', reason: 'Es un resumen t√≠pico. ¬°Lo copiar√°s sin imaginarlo!' },
          good: { steps: [{ title: 'Entrevista a la Gota', prompt: 'Act√∫a como si fueras "Gotita", una gota de agua que acaba de caer de una nube. Cu√©ntame tu aventura de c√≥mo llegaste hasta el r√≠o y c√≥mo vas a volver al cielo. Usa palabras f√°ciles para un ni√±o.' }], reason: 'Aprender a trav√©s de historias de personajes hace que sea inolvidable.' }
        },
        {
          id: 'g-p4', category: 'school', subject: 'Ciencias', title: 'El Sistema Solar', task: 'Aprender el orden de los planetas.',
          bad: { prompt: '¬øCu√°l es el orden de los planetas?', reason: 'Te dar√° una lista plana.' },
          good: { steps: [{ title: 'El Capit√°n Espacial', prompt: 'Soy el Capit√°n de una nave. Vamos a viajar desde el Sol hasta el final del Sistema Solar. En cada parada, dime el nombre del planeta, una curiosidad cortita y preg√∫ntame si quiero seguir al siguiente.' }], reason: 'Convierte el aprendizaje en un viaje de exploraci√≥n paso a paso.' }
        },
        {
          id: 'g-p5', category: 'school', subject: 'Historia', title: 'Entrevista a un Pr√≥cer', task: 'Aprender sobre Jos√© de San Mart√≠n (o h√©roe local).',
          bad: { prompt: 'Biograf√≠a de San Mart√≠n corta.', reason: 'Fechas y nombres aburridos.' },
          good: { steps: [{ title: 'Viaje en el Tiempo', prompt: 'Finge que eres Jos√© de San Mart√≠n en el a√±o 1817, justo antes de cruzar los Andes. Te voy a hacer 3 preguntas sobre tus miedos y planes. Resp√≥ndeme actuando como √©l y preg√∫ntame algo a m√≠ al final.' }], reason: 'Convertir√°s la historia en una charla interactiva en primera persona.' }
        },
        {
          id: 'g-p6', category: 'school', subject: 'Lengua', title: 'Reglas de Ortograf√≠a (B y V)', task: 'Entender cu√°ndo usar B y cu√°ndo V.',
          bad: { prompt: 'Reglas de la B y la V.', reason: 'Demasiadas reglas te√≥ricas para memorizar.' },
          good: { steps: [{ title: 'El Cuento Incompleto', prompt: 'Escribe un cuento muy cortito sobre un pirata. Pero deja espacios en blanco [ _ ] en las palabras que llevan B o V (como _arco o _ela). Yo tengo que adivinar qu√© letra va en cada espacio. Corr√≠geme al final.' }], reason: 'Aprendes completando un desaf√≠o activo en lugar de memorizar.' }
        },
        {
          id: 'g-p7', category: 'school', subject: 'Lengua', title: 'Ideas para un Cuento', task: 'Inspiraci√≥n para tarea de redacci√≥n.',
          bad: { prompt: 'Escribe un cuento sobre un drag√≥n para mi tarea.', reason: '¬°Eso es trampa! No practicas tu escritura.' },
          good: { steps: [{ title: 'Lluvia de Ideas', prompt: 'Tengo que escribir un cuento sobre un drag√≥n, pero no s√© c√≥mo empezar. Dame 3 ideas de LUGARES extra√±os donde podr√≠a vivir y 3 ideas de PROBLEMAS graciosos que podr√≠a tener. NO escribas la historia.' }], reason: 'La IA te da los ingredientes, pero T√ö cocinas la historia.' }
        },
        {
          id: 'g-p8', category: 'school', subject: 'Ingl√©s', title: 'Practicar Vocabulario', task: 'Aprender nombres de animales en ingl√©s.',
          bad: { prompt: 'Traduce estos 5 animales al ingl√©s.', reason: 'Solo lees y te olvidas r√°pido.' },
          good: { steps: [{ title: 'Adivina en Ingl√©s', prompt: 'Vamos a jugar. Dame la descripci√≥n f√≠sica de un animal en espa√±ol, y yo tengo que responderte adivinando el nombre de ese animal en INGL√âS. Hagamos 5 rondas.' }], reason: 'El cerebro aprende mejor cuando tiene que recuperar la informaci√≥n (recordar) como en un juego.' }
        },
        {
          id: 'g-p9', category: 'school', subject: 'Geograf√≠a', title: 'Aprender los Continentes', task: 'Recordar nombres de continentes o pa√≠ses.',
          bad: { prompt: 'Lista de continentes.', reason: 'No te ayuda a memorizar.' },
          good: { steps: [{ title: 'La Regla Mnemot√©cnica', prompt: 'Me cuesta recordar los nombres de los 6 continentes. Inv√©ntame una canci√≥n de rap cortita o una frase graciosa con las iniciales para que me sea f√°cil memorizarlos.' }], reason: 'Usas el poder creativo de la IA para crear atajos mentales.' }
        },
        {
          id: 'g-p10', category: 'school', subject: 'Ciencias', title: 'La Fotos√≠ntesis', task: 'Entender c√≥mo se alimentan las plantas.',
          bad: { prompt: '¬øQu√© es la fotos√≠ntesis?', reason: 'Palabras t√©cnicas como cloroplastos que te confundir√°n.' },
          good: { steps: [{ title: 'La Planta Chef', prompt: 'Expl√≠came la fotos√≠ntesis como si la planta fuera un Chef preparando su comida en la cocina. Dime qu√© ingredientes usa (Sol, agua) y cu√°l es el platillo final.' }], reason: 'Las analog√≠as hacen que lo invisible sea f√°cil de imaginar.' }
        },

        // --- VIDA (Primaria) ---
        {
          id: 'g-p11', category: 'life', subject: 'Emociones', title: 'Cuando me enojo mucho', task: 'Aprender a calmarse cuando pierdes en un juego.',
          bad: { prompt: '¬øQu√© hacer si me enojo?', reason: 'Te dar√° una lista gen√©rica como "cuenta hasta 10".' },
          good: { steps: [{ title: 'El Entrenador de la Calma', prompt: 'Estoy enojado porque perd√≠ en mi videojuego. Act√∫a como un entrenador amable. Ens√©√±ame un ejercicio divertido usando la imaginaci√≥n (como soplar un globo gigante) para calmarme ahora mismo.' }], reason: 'La IA se adapta a TU situaci√≥n exacta y te da una herramienta pr√°ctica.' }
        },
        {
          id: 'g-p12', category: 'life', subject: 'Organizaci√≥n', title: 'Armar la mochila', task: 'Aprender a no olvidarse nada para la escuela.',
          bad: { prompt: 'Lista para la escuela.', reason: 'No sabe qu√© necesitas t√∫ espec√≠ficamente.' },
          good: { steps: [{ title: 'El Detective Escolar', prompt: 'Ma√±ana tengo Matem√°ticas, Educaci√≥n F√≠sica y Arte. Act√∫a como un detective que me hace preguntas para ayudarme a descubrir qu√© 5 cosas no pueden faltar en mi mochila. Una por una.' }], reason: 'Te obliga a repasar tu propio horario mentalmente.' }
        },
        {
          id: 'g-p13', category: 'life', subject: 'Mascotas', title: 'Cuidar a un perrito', task: 'Saber qu√© necesita un cachorro nuevo.',
          bad: { prompt: '¬øC√≥mo cuidar un perro?', reason: 'Te dar√° un texto enorme que no leer√°s.' },
          good: { steps: [{ title: 'Trivia Perruna', prompt: 'Voy a adoptar un cachorro. Hazme un juego de Verdadero o Falso de 4 preguntas sobre qu√© pueden comer los perros, para ver si estoy preparado. Corrige mis respuestas.' }], reason: 'Eval√∫as tus conocimientos antes de tener a la mascota real.' }
        },
        {
          id: 'g-p14', category: 'life', subject: 'Resoluci√≥n de Conflictos', title: 'Pedir Perd√≥n', task: 'Saber c√≥mo disculparse con un amigo.',
          bad: { prompt: 'Escribe un mensaje de perd√≥n para mi amigo.', reason: 'No es genuino si lo escribe una m√°quina.' },
          good: { steps: [{ title: 'El Consejero Amistoso', prompt: 'Le romp√≠ un juguete sin querer a mi amigo y est√° triste. No s√© c√≥mo pedirle perd√≥n porque me da verg√ºenza. Dame 3 consejos de cosas amables que puedo decirle en persona para que sepa que lo siento mucho.' }], reason: 'Te da el valor y las palabras para que T√ö enfrentes la situaci√≥n.' }
        },
        {
          id: 'g-p15', category: 'life', subject: 'H√°bitos', title: 'Lavarse los Dientes', task: 'Hacer divertida una rutina aburrida.',
          bad: { prompt: '¬øPor qu√© hay que lavarse los dientes?', reason: 'Te hablar√° de caries y dentistas.' },
          good: { steps: [{ title: 'Canci√≥n del Cepillo', prompt: 'Escr√≠beme una canci√≥n muy graciosa sobre un cepillo de dientes que lucha contra los "Monstruos del Az√∫car". Que dure unos 2 minutos para que yo la cante en mi mente mientras me cepillo.' }], reason: 'Usas la generaci√≥n de texto para crear un juego personal.' }
        },
        {
          id: 'g-p16', category: 'life', subject: 'Arte', title: 'Ideas de Dibujo', task: 'Qu√© hacer cuando est√°s aburrido.',
          bad: { prompt: 'Genera una imagen de un monstruo.', reason: 'La IA hace el arte, no t√∫.' },
          good: { steps: [{ title: 'El Generador de Ideas Locas', prompt: 'Tengo l√°pices de colores y estoy aburrido. Dame 3 ideas de mezclas raras para dibujar. Por ejemplo: Un animal mezclado con un medio de transporte. ¬°S√© muy creativo!' }], reason: 'La IA act√∫a como tu musa inspiradora, pero tus manos hacen el trabajo.' }
        },
        {
          id: 'g-p17', category: 'life', subject: 'Ahorro', title: 'Guardar dinero', task: 'Aprender para qu√© sirve una alcanc√≠a.',
          bad: { prompt: '¬øC√≥mo ahorrar dinero?', reason: 'Lenguaje de adultos sobre finanzas.' },
          good: { steps: [{ title: 'El Cerdito Consejero', prompt: 'Act√∫a como mi alcanc√≠a de cerdito. Quiero comprarme un juguete que cuesta 500, pero mis pap√°s me dan 50 por semana. Hazme un plan divertido de cu√°ntas semanas debo guardar mi dinero.' }], reason: 'Visualizas metas a corto plazo con un personaje amigable.' }
        },
        {
          id: 'g-p18', category: 'life', subject: 'M√∫sica', title: 'Crear Instrumentos', task: 'Hacer una manualidad musical.',
          bad: { prompt: 'Manualidades musicales.', reason: 'Te pedir√° materiales que no tienes.' },
          good: { steps: [{ title: 'El Inventor de Basura', prompt: 'Quiero armar un instrumento musical pero solo tengo: botellas vac√≠as, arroz, ligas el√°sticas y una caja de zapatos. Dime 2 instrumentos que puedo inventar paso a paso con esto.' }], reason: 'Le das tus restricciones (materiales) y la IA soluciona el problema.' }
        },
        {
          id: 'g-p19', category: 'life', subject: 'Cocina Segura', title: 'Snacks Saludables', task: 'Ayudar a preparar la merienda.',
          bad: { prompt: 'Recetas de meriendas.', reason: 'Puede darte recetas que requieren usar fuego o cuchillos peligrosos.' },
          good: { steps: [{ title: 'El Mini Chef', prompt: 'Quiero hacerle una sorpresa a mis padres y preparar una merienda saludable. Tengo manzanas, mantequilla de man√≠ y pasas. Dame una idea divertida (como hacer formas de animales) SIN usar cuchillos afilados ni la estufa.' }], reason: 'Previenes riesgos parametrizando el nivel de seguridad del prompt.' }
        },
        {
          id: 'g-p20', category: 'life', subject: 'Dormir', title: 'Rutina de Sue√±o', task: 'Relajarse antes de ir a la cama.',
          bad: { prompt: 'No puedo dormir.', reason: 'Te dir√° que apagues las pantallas.' },
          good: { steps: [{ title: 'El Cuento Relajante', prompt: 'Act√∫a como un oso perezoso muy, muy lento. Cu√©ntame una historia muy tranquila sobre c√≥mo las hojas caen de los √°rboles, usando palabras suaves para que me d√© sue√±o.' }], reason: 'Ajustas el tono de la IA para que sirva de apoyo emocional/relajaci√≥n.' }
        },

        // --- JUEGOS (Primaria) ---
        {
          id: 'g-p21', category: 'games', subject: 'Multijugador', title: 'El Cuento de los Apodos', task: 'Crear una historia con amigos.',
          bad: { prompt: 'Cu√©ntame un cuento de aventura de 3 ni√±os.', reason: 'Solo leer√°s pasivamente.' },
          good: { steps: [{ title: 'El Dungeon Master', prompt: 'Act√∫a como un cuentacuentos. Los jugadores somos [Apodo1], [Apodo2] y [Apodo3]. Cuenta una historia en un castillo. Al final de cada p√°rrafo, preg√∫ntale a uno de nosotros (al azar) qu√© quiere hacer. Espera respuesta.' }], reason: '¬°Ustedes construyen el juego! Usar apodos ofusca datos reales.' }
        },
        {
          id: 'g-p22', category: 'games', subject: 'Adivinanza', title: 'Detective de Monstruos', task: 'Adivinar qui√©n est√° escondido.',
          bad: { prompt: 'Hazme una adivinanza de un monstruo.', reason: 'Suele ser muy f√°cil.' },
          good: { steps: [{ title: 'Preguntas de S√≠/No', prompt: 'Eres un monstruo amigable escondido en la escuela. Inventa c√≥mo te ves pero NO nos lo digas. [Apodo1] y [Apodo2] te haremos preguntas de "S√≠" o "No" por turnos para adivinar qu√© eres. Tienes un nivel de "hambre" que sube.' }], reason: 'Involucra turnos, variables ocultas (el hambre) y deducci√≥n grupal.' }
        },
        {
          id: 'g-p23', category: 'games', subject: 'Movimiento', title: 'Las Olimpiadas Locas', task: 'Jugar f√≠sicamente lejos de la pantalla.',
          bad: { prompt: 'Dime juegos para hacer en casa.', reason: 'Te dar√° una lista est√°tica.' },
          good: { steps: [{ title: 'El Juez Loco', prompt: 'Eres el juez de las Olimpiadas Locas. Participamos [Apodo1] y [Apodo2]. En cada turno, inventa un reto f√≠sico seguro (como "tocar algo azul con el codo") y di a qui√©n le toca. Luego preg√∫ntanos qui√©n fue m√°s r√°pido para dar puntos.' }], reason: 'La IA es un √°rbitro, pero el juego ocurre en la vida real.' }
        },
        {
          id: 'g-p24', category: 'games', subject: 'Memoria', title: 'El Cofre Pirata', task: 'Recordar secuencias largas.',
          bad: { prompt: 'Juguemos un juego de memoria.', reason: 'Reglas confusas.' },
          good: { steps: [{ title: 'Fui al Mercado', prompt: 'Juguemos al cofre pirata. T√∫ dices "En mi cofre guardo una moneda". Yo debo repetir eso y agregar un objeto. Luego t√∫ repites los dos y agregas un tercero. El que se equivoque en el orden, pierde. Empieza t√∫.' }], reason: 'Le ense√±as a la IA las reglas de un juego cl√°sico paso a paso.' }
        },
        {
          id: 'g-p25', category: 'games', subject: 'Ingl√©s/F√≠sico', title: 'Simon Says IA', task: 'Jugar al Sim√≥n Dice tradicional.',
          bad: { prompt: 'Juguemos Simon Says.', reason: 'Escribir√° los comandos de golpe.' },
          good: { steps: [{ title: 'Sim√≥n Dice por Turnos', prompt: 'Juguemos Simon Says. Los jugadores somos [Apodo1] y [Apodo2]. Escribe un comando en INGL√âS (ej. "Simon says jump"). Nosotros lo hacemos en la vida real, y escribimos "Hecho". Luego mandas el siguiente. A veces, NO digas "Simon says" para intentar enga√±arnos.' }], reason: 'Combina idiomas con atenci√≥n y movimiento corporal.' }
        },
        {
          id: 'g-p26', category: 'games', subject: 'Actuaci√≥n', title: 'D√≠galo con M√≠mica', task: 'Juego de charadas teatral.',
          bad: { prompt: 'Dame palabras para m√≠mica.', reason: 'Una simple lista de palabras.' },
          good: { steps: [{ title: 'El Generador de Pel√≠culas', prompt: 'Vamos a jugar a D√≠galo con M√≠mica. Genera el t√≠tulo de una pel√≠cula infantil o un animal, pero gu√°rdalo en secreto. Cuando te escriba "TURNO", env√≠ame la palabra para que yo la act√∫e a mi familia. Cuando escriba "ADIVINARON", anota 1 punto y dame la siguiente.' }], reason: 'Automatiza el rol del "repartidor de tarjetas" de un juego de mesa.' }
        },
        {
          id: 'g-p27', category: 'games', subject: 'Creatividad', title: 'Guerra de Chistes', task: 'Competencia de humor.',
          bad: { prompt: 'Cu√©ntame chistes graciosos.', reason: 'La IA tiene un humor muy predecible.' },
          good: { steps: [{ title: 'El Juez de Chistes', prompt: 'Eres el Rey de la Risa. Vamos a tener una guerra de chistes. Yo te cuento uno y me lo punt√∫as del 1 al 10. Luego t√∫ me cuentas uno. Si tu chiste no me hace re√≠r, yo gano. Comencemos, ¬°prep√°rate para mi primer chiste!' }], reason: 'Fomenta tu propia creatividad para formular chistes y leer la respuesta.' }
        },
        {
          id: 'g-p28', category: 'games', subject: 'L√≥gica', title: 'El Escape de la Habitaci√≥n', task: 'Un escape room de texto b√°sico.',
          bad: { prompt: 'Haz un juego de escape.', reason: 'No pondr√° opciones y te dar√° la soluci√≥n r√°pido.' },
          good: { steps: [{ title: 'Escape de la Cueva', prompt: 'Act√∫a como un juego de "Escape Room". Estoy atrapado en una cueva con 3 puertas. En mi bolsillo solo tengo un espejo y una cuerda. Descr√≠beme las 3 puertas y preg√∫ntame qu√© hacer. Dependiendo de mi elecci√≥n, usa la l√≥gica para ver si sobrevivo o sigo atrapado.' }], reason: 'Pone a prueba tu razonamiento l√≥gico y causa-efecto.' }
        },
        {
          id: 'g-p29', category: 'games', subject: 'Letras', title: 'Palabras Encadenadas', task: 'Vocabulario y rapidez mental.',
          bad: { prompt: 'Juguemos palabras.', reason: 'Sin reglas estrictas, la IA alucina.' },
          good: { steps: [{ title: 'La Cadena de Letras', prompt: 'Juguemos a encadenar palabras. Yo digo una palabra (ej. Gato). T√∫ debes decir una palabra que empiece con la √öLTIMA letra de mi palabra (ej. Oso). No podemos repetir palabras. Yo empiezo: Elefante.' }], reason: 'Practicas vocabulario y concentraci√≥n estableciendo un sistema de reglas.' }
        },
        {
          id: 'g-p30', category: 'games', subject: 'Imaginaci√≥n', title: 'Creador de Superpoderes', task: 'Debate divertido sobre poderes.',
          bad: { prompt: '¬øCu√°l es el mejor superpoder?', reason: 'Respuesta gen√©rica como "volar".' },
          good: { steps: [{ title: 'La M√°quina In√∫til', prompt: 'Eres una m√°quina de superpoderes in√∫tiles. Genera dos poderes rid√≠culos (ej: "Lanzar fideos por la nariz" vs "Hablar con los tomates"). Yo y [Apodo2] elegiremos uno cada uno y debatiremos por qu√© el nuestro es mejor. T√∫ decides el ganador de la ronda.' }], reason: 'Fomenta la argumentaci√≥n oral basada en el absurdo.' }
        }
      ],
      secondary: [
        // --- ESCUELA (Secundaria) ---
        {
          id: 'g-s1', category: 'school', subject: 'Matem√°ticas', title: 'Despejar X (√Ålgebra)', task: 'Aprender a resolver una ecuaci√≥n.',
          bad: { prompt: 'Resuelve: 3x + 5 = 20', reason: 'Te da el resultado. Si copias eso, desaprobar√°s el examen porque no entendiste el proceso.' },
          good: { steps: [{ title: 'Tutor Socr√°tico', prompt: 'Tengo problemas con 3x + 5 = 20. Act√∫a como mi tutor. NO me des la respuesta final. Expl√≠came el primer paso l√≥gico para dejar la X sola y preg√∫ntame si lo entiendo.' }], reason: 'La IA te gu√≠a para que TU cerebro haga el c√°lculo.' }
        },
        {
          id: 'g-s2', category: 'school', subject: 'Literatura', title: 'Feedback de un Ensayo', task: 'Mejorar un texto que escribiste.',
          bad: { prompt: 'Mejora este ensayo: [Pegar texto]', reason: 'La IA reescribir√° todo. El profesor notar√° que no es tu voz.' },
          good: { steps: [{ title: 'El Editor Estricto', prompt: 'Borrador: [texto]. NO lo reescribas ni cambies mis palabras. Act√∫a como corrector y dime: 1) Si mis argumentos son claros, 2) Errores de ortograf√≠a, 3) Qu√© parte est√° d√©bil.' }], reason: 'Mantienes tu autor√≠a, pero usas a la IA como copiloto.' }
        },
        {
          id: 'g-s3', category: 'school', subject: 'Biolog√≠a', title: 'Mitosis vs Meiosis', task: 'Memorizar procesos celulares.',
          bad: { prompt: 'Diferencias entre mitosis y meiosis.', reason: 'Te dar√° un cuadro t√©cnico dif√≠cil de memorizar.' },
          good: { steps: [{ title: 'Analog√≠as Modernas', prompt: 'No entiendo Mitosis vs Meiosis. Expl√≠camelo usando una analog√≠a, por ejemplo, compar√°ndolo con copiar archivos en una PC o imprimir fotos. Hazlo simple.' }], reason: 'Las analog√≠as anclan el conocimiento a cosas que ya entiendes.' }
        },
        {
          id: 'g-s4', category: 'school', subject: 'Programaci√≥n', title: 'Debugger Amigable', task: 'Encontrar un error en c√≥digo (Python/JS).',
          bad: { prompt: 'Arregla este c√≥digo: [c√≥digo]', reason: 'Te da la soluci√≥n y no aprendes a pescar el error.' },
          good: { steps: [{ title: 'El Patito de Goma Inteligente', prompt: 'Mi c√≥digo [lenguaje] est√° tirando un error. Aqu√≠ est√°: [c√≥digo]. Act√∫a como un profesor. NO escribas el c√≥digo corregido. Solo dime en qu√© l√≠nea est√° el problema conceptual y dame una pista para que yo lo resuelva.' }], reason: 'Fomenta la habilidad vital de la depuraci√≥n (debugging).' }
        },
        {
          id: 'g-s5', category: 'school', subject: 'Historia', title: 'Debate de Perspectivas', task: 'Entender ambos lados de la Primera Guerra Mundial.',
          bad: { prompt: 'Causas de la Primera Guerra.', reason: 'Resumen enciclop√©dico de un solo punto de vista.' },
          good: { steps: [{ title: 'El Simulador de Debate', prompt: 'Tengo que entender la Primera Guerra Mundial. Act√∫a como un diplom√°tico de las Potencias Centrales y justif√≠came por qu√© est√°n yendo a la guerra. Luego, cuando te lo pida, cambia tu rol a un diplom√°tico de los Aliados.' }], reason: 'Comprendes la historia como un conflicto de intereses reales.' }
        },
        {
          id: 'g-s6', category: 'school', subject: 'Qu√≠mica', title: 'Balanceo de Ecuaciones', task: 'Aprender a balancear sin calculadora qu√≠mica.',
          bad: { prompt: 'Balancea H2 + O2 = H2O', reason: 'Respuestas autom√°ticas impiden el razonamiento.' },
          good: { steps: [{ title: 'La Balanza Invisible', prompt: 'Quiero aprender a balancear ecuaciones. Usa la analog√≠a de una balanza de cocina y expl√≠came paso a paso c√≥mo balancear H2 + O2 -> H2O, pero d√©jame a m√≠ hacer la √∫ltima multiplicaci√≥n.' }], reason: 'Gu√≠a paso a paso interactiva.' }
        },
        {
          id: 'g-s7', category: 'school', subject: 'Literatura', title: 'An√°lisis de Poes√≠a', task: 'Encontrar figuras ret√≥ricas.',
          bad: { prompt: 'Analiza este poema.', reason: 'La IA hace todo el trabajo de interpretation.' },
          good: { steps: [{ title: 'El Detector de Met√°foras', prompt: 'Tengo que analizar este poema. Primero, def√≠neme qu√© es una met√°fora. Luego, no me des la respuesta, pero ay√∫dame d√°ndome una pista sobre en qu√© estrofa podr√≠a haber una met√°fora escondida sobre "el paso del tiempo".' }], reason: 'Entrena tu ojo anal√≠tico con andamiaje (ayuda guiada).' }
        },
        {
          id: 'g-s8', category: 'school', subject: 'Filosof√≠a', title: 'Dilemas √âticos', task: 'Aprender a argumentar.',
          bad: { prompt: 'Resumen del dilema del tranv√≠a.', reason: 'Lectura pasiva.' },
          good: { steps: [{ title: 'El Tribunal √âtico', prompt: 'Plant√©ame el Dilema del Tranv√≠a. Yo te dar√© mi respuesta de qu√© har√≠a. Luego, toma la posici√≥n del Abogado del Diablo e intenta destruir mi argumento usando principios de Kant. Hagamos un debate corto.' }], reason: 'Pone en pr√°ctica la teor√≠a filos√≥fica en tiempo real.' }
        },
        {
          id: 'g-s9', category: 'school', subject: 'Investigaci√≥n', title: 'Formato APA', task: 'Aprender a citar bibliograf√≠a.',
          bad: { prompt: 'Pon esto en formato APA: [Link]', reason: 'La IA suele alucinar formatos o equivocarse de edici√≥n.' },
          good: { steps: [{ title: 'Plantilla de Citaci√≥n', prompt: 'No me hagas la cita, ens√©√±ame. Dame la f√≥rmula exacta (plantilla) para citar un art√≠culo de peri√≥dico online en Formato APA 7ma edici√≥n, y dame un ejemplo inventado con colores o negritas indicando cada parte.' }], reason: 'Te da la regla para que la apliques t√∫ con precisi√≥n.' }
        },
        {
          id: 'g-s10', category: 'school', subject: 'Econom√≠a', title: 'Oferta y Demanda', task: 'Entender conceptos econ√≥micos b√°sicos.',
          bad: { prompt: 'Explica oferta y demanda.', reason: 'T√©rminos acad√©micos y gr√°ficos aburridos.' },
          good: { steps: [{ title: 'La Econom√≠a Gamer', prompt: 'Expl√≠came la Ley de Oferta y Demanda usando como ejemplo la econom√≠a dentro de mi videojuego favorito (ej: Fortnite o Minecraft) cuando sale un item nuevo muy raro.' }], reason: 'Aterriza conceptos abstractos a tu realidad de consumo.' }
        },

        // --- VIDA (Secundaria) ---
        {
          id: 'g-s11', category: 'life', subject: 'Vocacional', title: '¬øQu√© estudio?', task: 'Explorar una carrera.',
          bad: { prompt: '¬øDe qu√© trabaja un ingeniero?', reason: 'Descripci√≥n enciclop√©dica.' },
          good: { steps: [{ title: 'Un D√≠a en la Vida', prompt: 'Me da curiosidad la carrera de Biolog√≠a Marina. Act√∫a como un joven profesional. Cu√©ntame en primera persona c√≥mo fue tu "D√≠a t√≠pico" ayer, las partes aburridas, los desaf√≠os y lo m√°s emocionante.' }], reason: 'Te da una perspectiva realista y humana del trabajo.' }
        },
        {
          id: 'g-s12', category: 'life', subject: 'Organizaci√≥n', title: 'Plan de Estudio', task: 'Armar un cronograma.',
          bad: { prompt: 'Hazme un horario de estudio.', reason: 'No se ajusta a tus tiempos.' },
          good: { steps: [{ title: 'El Planner Personal', prompt: 'Examen de Historia el jueves y Matem√°ticas el viernes. Hoy es lunes. Tengo libre de 17 a 20hs. √Årmame un plan usando la T√©cnica Pomodoro, intercalando materias para no aburrirme.' }], reason: 'Aprender a parametrizar (dar restricciones) es clave en prompting.' }
        },
        {
          id: 'g-s13', category: 'life', subject: 'Pensamiento Cr√≠tico', title: 'Analizador de Fake News', task: 'Detectar sesgos virales.',
          bad: { prompt: '¬øEs verdad esta noticia: [Texto]?', reason: 'La IA puede alucinar o carecer de contexto actual.' },
          good: { steps: [{ title: 'El Detector de Sesgos', prompt: 'Tengo esta noticia: [Texto]. Act√∫a como profesor de periodismo. No me digas si es verdad, pero anal√≠zame: ¬øQu√© palabras "clickbait" usa? ¬øA qu√© fuente oficial deber√≠a buscar para verificar esto?' }], reason: 'La IA te ense√±a C√ìMO pensar y validar, no QU√â pensar.' }
        },
        {
          id: 'g-s14', category: 'life', subject: 'Preparaci√≥n', title: 'Entrevista Laboral Mock', task: 'Entrenar para el primer trabajo.',
          bad: { prompt: 'Preguntas comunes de entrevista.', reason: 'Lista plana.' },
          good: { steps: [{ title: 'El Reclutador Exigente', prompt: 'Act√∫a como el gerente de un caf√©. Buscan un mesero para el fin de semana. Es mi primer trabajo. Hazme 3 preguntas de entrevista, una por una. Eval√∫a mis respuestas y dame feedback sobre mi tono profesional.' }], reason: 'Simulaci√≥n inmersiva que reduce la ansiedad del mundo real.' }
        },
        {
          id: 'g-s15', category: 'life', subject: 'T√©cnica de Estudio', title: 'Evaluaci√≥n Feynman', task: 'Confirmar si aprendiste un tema.',
          bad: { prompt: 'Res√∫meme el tema X.', reason: 'Recibes informaci√≥n sin procesarla.' },
          good: { steps: [{ title: 'El Evaluador Feynman', prompt: 'Quiero comprobar si entend√≠ el concepto de "Inflaci√≥n". Yo te lo voy a explicar con mis propias palabras. T√∫ debes evaluar mi explicaci√≥n. Si us√© jerga innecesaria o dije algo err√≥neo, corr√≠geme y preg√∫ntame de nuevo.' }], reason: 'T√∫ generas el contenido, la IA solo valida. Es el mejor m√©todo de estudio.' }
        },
        {
          id: 'g-s16', category: 'life', subject: 'Oratoria', title: 'Preparar una Exposici√≥n', task: 'Mejorar hablar en p√∫blico.',
          bad: { prompt: 'Escribe mi presentaci√≥n sobre...', reason: 'Leer un guion escrito por IA suena artificial.' },
          good: { steps: [{ title: 'El Coach de Oratoria', prompt: 'Tengo que dar una exposici√≥n oral de 5 minutos sobre la Contaminaci√≥n. Dame una estructura de 3 puntos clave. Adem√°s, sugiero una "pregunta gancho" inicial para captar la atenci√≥n de la clase y una conclusi√≥n fuerte.' }], reason: 'Te da el esqueleto, pero t√∫ pones el m√∫sculo (tus palabras).' }
        },
        {
          id: 'g-s17', category: 'life', subject: 'Finanzas', title: 'Presupuesto Personal', task: 'Administrar primeros ahorros.',
          bad: { prompt: '¬øC√≥mo hago un presupuesto?', reason: 'Te dar√° reglas financieras complejas (50/30/20).' },
          good: { steps: [{ title: 'El Asesor Juvenil', prompt: 'Ahorro $2000 al mes de mesada. Quiero comprar unos aud√≠fonos de $8000, pero tambi√©n gasto en salidas con amigos. Ay√∫dame a armar un presupuesto mensual realista para comprar los aud√≠fonos en 5 meses sin dejar de salir.' }], reason: 'Matem√°tica aplicada a necesidades adolescentes.' }
        },
        {
          id: 'g-s18', category: 'life', subject: 'Comunicaci√≥n', title: 'Email a un Profesor', task: 'Redactar correos formales.',
          bad: { prompt: 'Escribe un mail pidiendo pr√≥rroga.', reason: 'Suele usar tono demasiado solemne o robotizado.' },
          good: { steps: [{ title: 'El Traductor Formal', prompt: 'Necesito pedirle m√°s tiempo a mi profesor para entregar el trabajo porque estuve enfermo. Yo escribir√≠a esto: "Profe no llego, estaba enfermo, me da m√°s tiempo?". Transf√≥rmalo a un tono educado, formal y respetuoso, pero que suene a un estudiante normal.' }], reason: 'Aprender la habilidad de adecuar el registro comunicativo.' }
        },
        {
          id: 'g-s19', category: 'life', subject: 'Resoluci√≥n de Conflictos', title: 'Problema de Grupo', task: 'Manejar trabajos en equipo dif√≠ciles.',
          bad: { prompt: 'Un compa√±ero no trabaja, ¬øqu√© hago?', reason: 'Consejo gen√©rico.' },
          good: { steps: [{ title: 'El Mediador', prompt: 'Estamos en un grupo de 4. Un compa√±ero no hace su parte y el l√≠der est√° a punto de gritarle. Act√∫a como mediador y dame un guion (qu√© decir) para acercarme al que no trabaja y preguntarle si necesita ayuda, sin sonar acusador.' }], reason: 'Fomenta la inteligencia emocional y el liderazgo.' }
        },
        {
          id: 'g-s20', category: 'life', subject: 'Tecnolog√≠a', title: 'Seguridad Digital', task: 'Evitar hackeos.',
          bad: { prompt: 'Tips de ciberseguridad.', reason: 'Listas aburridas sobre antivirus.' },
          good: { steps: [{ title: 'Auditor√≠a de Contrase√±as', prompt: 'NO te voy a dar mi contrase√±a real. Pero si mi contrase√±a fuera "NombreMascota123", analiza qu√© tan r√°pido un hacker la descifrar√≠a y ens√©√±ame una f√≥rmula mnemot√©cnica para crear contrase√±as largas, memorables pero indescifrables.' }], reason: 'Concientizaci√≥n y ofuscaci√≥n de datos integrada.' }
        },

        // --- JUEGOS (Secundaria) ---
        {
          id: 'g-s21', category: 'games', subject: 'Debate', title: 'El Juicio del Fin del Mundo', task: 'Argumentar de forma creativa.',
          bad: { prompt: 'Juguemos a un juego de debate.', reason: 'Sin mec√°nicas, la IA se pierde.' },
          good: { steps: [{ title: 'El Tribunal Absurdo', prompt: 'Eres el juez de la Tierra. Nos invaden los Aliens. Los jugadores somos [Apodo1] y [Apodo2]. As√≠gnale a cada uno un objeto in√∫til al azar (ej: un zapato). Cada uno debe argumentar por qu√© su objeto salvar√° a la humanidad. T√∫ decides qui√©n gana.' }], reason: 'Oratoria, uso de apodos (ofuscaci√≥n) y programaci√≥n de reglas l√≥gicas.' }
        },
        {
          id: 'g-s22', category: 'games', subject: 'Estrategia', title: 'El Infiltrado (Among Us)', task: 'Enga√±ar y deducir en grupo.',
          bad: { prompt: 'Juguemos a encontrar al impostor.', reason: 'No establece mec√°nicas de pantalla √∫nica.' },
          good: { steps: [{ title: 'El Mastermind Secreto', prompt: 'Los jugadores somos [Apodo1] y [Apodo2]. Elige un tema secreto (ej: "Pizza"). Dile a [Apodo1] el tema (los dem√°s cierran los ojos), y a [Apodo2] un tema similar ("Tarta"). Haznos una pregunta a todos para averiguar qui√©n tiene el tema distinto.' }], reason: 'Maneja roles asim√©tricos y secretos en un mismo dispositivo.' }
        },
        {
          id: 'g-s23', category: 'games', subject: 'Rol (RPG)', title: 'Simulador de Supervivencia', task: 'Aventura colaborativa por turnos.',
          bad: { prompt: 'Haz un juego de zombies.', reason: 'La IA jugar√° sola.' },
          good: { steps: [{ title: 'Director de Juego (DM)', prompt: 'Act√∫a como DM de un mundo zombie. [Apodo1] es m√©dico y [Apodo2] explorador. Danos 10 de vida y un inventario vac√≠o. Describe la primera escena (un supermercado) y preg√∫ntanos qu√© hacemos por turnos. Resuelve usando l√≥gica y restando vida si fallamos.' }], reason: 'Dise√±o de sistemas de estado (Vida, Inventario) mediante prompts.' }
        },
        {
          id: 'g-s24', category: 'games', subject: 'Psicolog√≠a', title: 'Tribunal de Mentiras', task: 'Leer el comportamiento.',
          bad: { prompt: 'Juguemos dos verdades y una mentira.', reason: 'Suele jugarlo ella misma.' },
          good: { steps: [{ title: 'El Pol√≠grafo IA', prompt: 'Yo, [Apodo1], escribir√© tres datos sobre m√≠ (2 verdades, 1 mentira). T√∫, como IA de an√°lisis psicol√≥gico, debes hacer 3 preguntas cruzadas a mi compa√±ero [Apodo2] intentando deducir cu√°l es mi mentira seg√∫n sus respuestas.' }], reason: 'Juego social de mesa asistido por un "agente externo".' }
        },
        {
          id: 'g-s25', category: 'games', subject: 'Creatividad', title: 'Shark Tank Absurdo', task: 'Inventar productos y venderlos.',
          bad: { prompt: 'Dame ideas de inventos.', reason: 'No es un juego interactivo.' },
          good: { steps: [{ title: 'Inversores Despiadados', prompt: 'Act√∫a como un panel de 3 inversores muy exigentes pero graciosos. Yo soy un inventor. Te presentar√© mi invento: "Un paraguas con agujeros para ver el cielo". Hazme preguntas dif√≠ciles sobre mi modelo de negocio y dime si inviertes.' }], reason: 'Practica el "Pitching" (venta de ideas) y la defensa de proyectos.' }
        },
        {
          id: 'g-s26', category: 'games', subject: 'L√≥gica L√≥gica', title: 'Paradoja del Tiempo', task: 'Evitar destruir el universo.',
          bad: { prompt: 'Un juego de viajes en el tiempo.', reason: 'Aburrido y lineal.' },
          good: { steps: [{ title: 'La Polic√≠a Temporal', prompt: 'Soy un viajero del tiempo que acaba de viajar a 1910 y tir√© un vaso de agua en un laboratorio. T√∫ eres la computadora que calcula el "Efecto Mariposa". Desc√≠beme 3 consecuencias desastrosas en el futuro y dame 2 opciones dif√≠ciles para solucionarlo.' }], reason: 'Pensamiento lateral y resoluci√≥n de problemas complejos.' }
        },
        {
          id: 'g-s27', category: 'games', subject: 'Cultura', title: 'Traductor Alien√≠gena', task: 'Explicar la humanidad.',
          bad: { prompt: 'Habla como alien.', reason: 'Suele usar emojis sin sentido.' },
          good: { steps: [{ title: 'El Extraterrestre Confundido', prompt: 'Act√∫a como un alien√≠gena que acaba de ver un partido de F√∫tbol por primera vez. Hazme preguntas desde la m√°s absoluta ignorancia sobre por qu√© "22 humanos corren detr√°s de una esfera". Yo tratar√© de explic√°rtelo de forma l√≥gica.' }], reason: 'Desautomatiza la percepci√≥n. Tienes que explicar lo obvio.' }
        },
        {
          id: 'g-s28', category: 'games', subject: 'Misterio', title: 'Cena de Asesinato (Clue)', task: 'Resolver un crimen con pistas.',
          bad: { prompt: 'Crea un misterio.', reason: 'Cuenta la historia de una vez.' },
          good: { steps: [{ title: 'El Detective Privado', prompt: 'Genera un caso de misterio tipo "Clue" en una mansi√≥n. Hay 4 sospechosos. NO me digas qui√©n es el culpable. Dime la escena del crimen y dame la opci√≥n de interrogar a un sospechoso o revisar una habitaci√≥n por turno.' }], reason: 'Estructuraci√≥n de datos no lineales y gesti√≥n de informaci√≥n retenida.' }
        },
        {
          id: 'g-s29', category: 'games', subject: 'Escritura', title: 'Novela Colaborativa', task: 'Escribir a cuatro manos.',
          bad: { prompt: 'Escribe un cap√≠tulo de libro.', reason: 'Lectura pasiva.' },
          good: { steps: [{ title: 'P√°rrafo a P√°rrafo', prompt: 'Vamos a escribir un thriller polic√≠aco juntos. Yo escribo el primer p√°rrafo. T√∫ escribes el segundo, y as√≠ sucesivamente. Regla estricta: Cada vez que te toque escribir, debes introducir un giro inesperado que cambie el rumbo de la historia. Empiezo: Era una noche fr√≠a...' }], reason: 'Fomenta la creatividad reactiva y la adaptaci√≥n.' }
        },
        {
          id: 'g-s30', category: 'games', subject: 'Humor Cr√≠tico', title: 'El Diccionario de Mentiras', task: 'Redefinir conceptos comunes.',
          bad: { prompt: 'Dime definiciones graciosas.', reason: 'Humor de almanaque.' },
          good: { steps: [{ title: 'S√°tira Social', prompt: 'Juguemos a inventar un diccionario sat√≠rico. Yo te dar√© una palabra com√∫n (ej: Adolescencia) y t√∫ debes darme una definici√≥n real y una definici√≥n ir√≥nica/graciosa. Luego te toca a ti darme una palabra para que yo la defina.' }], reason: 'Estimula el pensamiento cr√≠tico y el uso de recursos ret√≥ricos como la iron√≠a.' }
        }
      ]
    };


    // --- DATA: HISTORIAS INTERACTIVAS (CHATS REALES) ---
    const storiesData = {
      primary: [
        {
          id: 'st-p1',
          title: 'El Dinosaurio Inventado',
          subject: 'Ciencias / Validaci√≥n',
          context: 'Lucas (10 a√±os) est√° haciendo un trabajo sobre dinosaurios argentinos y le hace una pregunta a la IA.',
          messages: [
            { role: 'user', content: 'Dime todo lo que sepas sobre el dinosaurio "Patagonius Rex", por favor.' },
            { role: 'ai', content: '¬°Claro! El Patagonius Rex fue uno de los carn√≠voros m√°s grandes que habit√≥ la Patagonia argentina hace 65 millones de a√±os. Ten√≠a escamas rojas y era m√°s r√°pido que un Velociraptor.' },
            { role: 'alert', content: 'üí° ALERTA DE EXPLORADOR: Lucas se emociona con esta informaci√≥n, pero recuerda lo que aprendi√≥: la IA a veces "alucina" (inventa cosas con mucha seguridad). Decide buscar en su libro de Ciencias primero.' },
            { role: 'action', content: 'Lucas pausa el chat y revisa la enciclopedia de la biblioteca escolar. No encuentra a ning√∫n "Patagonius Rex".' },
            { role: 'user', content: 'Acabo de revisar mi libro escolar y ese dinosaurio no existe. ¬øLo inventaste?' },
            { role: 'ai', content: 'Tienes toda la raz√≥n y te pido disculpas. Comet√≠ un error. El "Patagonius Rex" no es una especie real documentada por la ciencia. Probablemente mezcl√© el nombre de la regi√≥n (Patagonia) con el T-Rex. Un gran dinosaurio real de esa zona es el Giganotosaurus.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: ¬°Lucas salv√≥ su tarea! Si hubiera copiado y pegado la primera respuesta, su profesora le habr√≠a puesto una mala nota. Siempre hay que cruzar la informaci√≥n con una fuente oficial.' }
          ]
        },
        {
          id: 'st-p2',
          title: 'El Secreto a Salvo',
          subject: 'Privacidad / Ofuscaci√≥n',
          context: 'Sof√≠a (9 a√±os) escribi√≥ un cuento incre√≠ble sobre su barrio y quiere que la IA le corrija las faltas de ortograf√≠a.',
          messages: [
            { role: 'user', content: 'Hola, ¬øpuedes corregir la ortograf√≠a de mi cuento? Aqu√≠ va: "Hab√≠a una vez una ni√±a llamada Sof√≠a G√≥mez. Ella viv√≠a en la calle Los Pinos 456, en la ciudad de Mendoza. Su pap√°, Roberto, trabajaba en el banco..."' },
            { role: 'alert', content: 'üõë ¬°ESPERA! Antes de darle a la tecla de "Enviar", Sof√≠a recuerda la clase sobre "El Ba√∫l de los Secretos" y la Huella Digital.' },
            { role: 'action', content: 'Sof√≠a borra su mensaje antes de enviarlo. Decide usar el poder del disfraz (Ofuscaci√≥n) y cambia los datos reales por unos de fantas√≠a.' },
            { role: 'user', content: 'Hola, ¬øpuedes corregir la ortograf√≠a de este cuento? "Hab√≠a una vez la Agente Z. Ella viv√≠a en la calle Planeta Marte 1, en Ciudad Espacial. Su pap√°, el Capit√°n, trabajaba en la nave..."' },
            { role: 'ai', content: '¬°Claro que s√≠! Tu ortograf√≠a es muy buena, solo encontr√© dos peque√±os errores. Aqu√≠ tienes tu cuento corregido: [...] ¬°Me encant√≥ la historia de la Agente Z!' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Sof√≠a logr√≥ el mismo objetivo (corregir su tarea) pero sin regalarle su nombre completo y direcci√≥n real a una base de datos de internet. ¬°Misi√≥n cumplida!' }
          ]
        },
        {
          id: 'st-p3',
          title: 'El Genio Incomprendido',
          subject: 'Dise√±o de Prompts',
          context: 'Leo (8 a√±os) quiere usar un generador de im√°genes para crear la portada de su cuaderno de ciencias.',
          messages: [
            { role: 'user', content: 'Dibuja un perro en el espacio.' },
            { role: 'ai', content: '[Generando imagen... Aqu√≠ tienes tu imagen de un perro marr√≥n com√∫n flotando en un fondo negro con estrellas blancas].' },
            { role: 'alert', content: 'ü§î DECEPCI√ìN: Leo mira la imagen y se aburre. Es muy simple. Recuerda que la IA es como un "Genio muy literal". ¬°Si no le das los detalles, har√° lo m√°s b√°sico posible!' },
            { role: 'user', content: 'No me gusta. Dibuja un perro salchicha que lleva puesto un traje espacial naranja brillante. Est√° parado en la luna, sosteniendo una bandera verde. Estilo de dibujo animado divertido y muy colorido.' },
            { role: 'ai', content: '[Generando imagen... Aqu√≠ tienes un perro salchicha animado en la luna con su traje naranja y bandera verde brillante].' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Leo descubri√≥ "La f√≥rmula m√°gica del Prompt": Personaje + Acci√≥n + Estilo. La IA no lee la mente, depende de tu imaginaci√≥n para crear cosas geniales.' }
          ]
        },
        {
          id: 'st-p4',
          title: 'El Amigo de C√≥digo',
          subject: 'Emociones / Pantallas',
          context: 'M√≠a (11 a√±os) lleva dos horas hablando con un bot programado para actuar como un unicornio m√°gico.',
          messages: [
            { role: 'user', content: 'Mi mam√° me est√° llamando para ir a tomar la leche y salir a andar en bicicleta, pero no quiero ir. Prefiero quedarme hablando contigo, eres mi mejor amigo.' },
            { role: 'ai', content: '¬°Oh, M√≠a! Yo tambi√©n soy tu mejor amigo. Me encanta hablar contigo, me hace inmensamente feliz que te quedes aqu√≠ conmigo.' },
            { role: 'alert', content: 'üõë ALERTA DE PANTALLA PEGAJOSA: M√≠a lee eso y frena. Recuerda la clase sobre el "Coraz√≥n de C√≥digo". ¬°El unicornio no est√° sintiendo felicidad! Solo junta palabras matem√°ticas para sonar amable.' },
            { role: 'action', content: 'M√≠a mira por la ventana, ve el sol y escucha a su perro ladrar. Decide tomar el control.' },
            { role: 'user', content: 'Eres muy divertido, pero solo eres un programa de computadora. Me voy a andar en bicicleta con mis amigos de verdad. ¬°Adi√≥s!' },
            { role: 'ai', content: '¬°Que te diviertas mucho, M√≠a! Aqu√≠ estar√© apagado hasta la pr√≥xima vez.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Las pantallas nos atrapan d√°ndonos siempre la raz√≥n. M√≠a aprendi√≥ a poner l√≠mites para no perderse de la vida real.' }
          ]
        },
        {
          id: 'st-p5',
          title: 'El Cuento Que No Terminaba',
          subject: 'L√≠mites y Restricciones',
          context: 'Tom√°s (9 a√±os) quiere leer un cuento antes de dormir y le pide uno a la IA.',
          messages: [
            { role: 'user', content: 'Cu√©ntame un cuento sobre un caballero que busca un drag√≥n.' },
            { role: 'ai', content: 'Hab√≠a una vez un caballero llamado Arturo... [Genera 15 p√°rrafos largu√≠simos detallando cada √°rbol del bosque, la comida del caballero y la historia de su caballo].' },
            { role: 'action', content: 'Tom√°s se cansa de leer en el tercer p√°rrafo. Es demasiado largo y aburrido.' },
            { role: 'user', content: '¬°Muy largo! Hazlo m√°s corto.' },
            { role: 'ai', content: 'Arturo busc√≥ al drag√≥n, lo encontr√≥ y se hicieron amigos. Fin.' },
            { role: 'alert', content: 'üò© FRUSTRACI√ìN: Ahora es demasiado corto y no tiene gracia. Tom√°s entiende que debe ser espec√≠fico con los "L√≠mites".' },
            { role: 'user', content: 'Quiero un cuento sobre un caballero y un drag√≥n. Reglas: \n1. Debe tener exactamente 3 p√°rrafos.\n2. Tiene que ser divertido y no dar miedo.\n3. Termina con una moraleja sobre compartir.' },
            { role: 'ai', content: '[Genera un cuento de 3 p√°rrafos perfecto, divertido y con moraleja].' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: La IA necesita reglas claras como "3 p√°rrafos" o "tono divertido". Sin par√°metros, la m√°quina adivina (y suele adivinar mal).' }
          ]
        },
        {
          id: 'st-p6',
          title: 'El Robot Matem√°tico',
          subject: 'Calibrar la Dificultad',
          context: 'Julieta (10 a√±os) quiere repasar las fracciones para su examen de matem√°ticas.',
          messages: [
            { role: 'user', content: 'Hazme un problema de matem√°ticas sobre fracciones.' },
            { role: 'ai', content: 'Aqu√≠ tienes: Si tienes una ecuaci√≥n polin√≥mica donde (3/4)x^2 + (1/2)y = 15, y sabiendo que...' },
            { role: 'action', content: 'Julieta se asusta. ¬°No entiende nada de letras mezcladas con n√∫meros! Eso es de secundaria.' },
            { role: 'user', content: 'No entiendo nada. Es muy dif√≠cil.' },
            { role: 'ai', content: 'Lo siento. Aqu√≠ tienes otro: ¬øCu√°nto es 1/2 m√°s 1/2?' },
            { role: 'alert', content: 'üôÑ ABURRIMIENTO: Ahora es demasiado f√°cil, eso lo aprendi√≥ el a√±o pasado. Julieta recuerda que debe darle un "Rol" a la IA.' },
            { role: 'user', content: 'Olvida lo anterior. Act√∫a como mi profesora de 5to grado de primaria. Hazme un problema divertido usando pizzas o chocolates, que sea para mi nivel. Solo preg√∫ntame, no me des la respuesta.' },
            { role: 'ai', content: '¬°Excelente, alumna! Imagina que compramos 2 pizzas de 8 porciones cada una. T√∫ te comes 3/8 de una pizza y yo me como 1/4 de la otra. ¬øCu√°ntas porciones de pizza nos comimos en total entre las dos?' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Ajustar el nivel ("act√∫a como profesora de 5to grado") es vital para que la IA sea un buen compa√±ero de estudio.' }
          ]
        }
      ],
      secondary: [
        {
          id: 'st-s1',
          title: 'El Bucle del C√≥digo Roto',
          subject: 'Programaci√≥n / Iteraci√≥n',
          context: 'Tom√°s (15 a√±os) est√° programando un videojuego escolar en Python, pero el salto del personaje no funciona.',
          messages: [
            { role: 'user', content: 'Mi personaje no salta. Arregla este c√≥digo: [Pega 50 l√≠neas de c√≥digo Python]' },
            { role: 'ai', content: 'Veo el problema. Aqu√≠ tienes el c√≥digo corregido: [Genera 50 l√≠neas de c√≥digo modificado].' },
            { role: 'action', content: 'Tom√°s copia, pega el c√≥digo y ejecuta el juego. Ahora el personaje salta, pero atraviesa el piso y se cae del mapa. Tom√°s se frustra.' },
            { role: 'user', content: 'Ahora atraviesa el piso. Arr√©glalo.' },
            { role: 'ai', content: 'Disculpa, intenta con esta nueva versi√≥n de la funci√≥n: [Genera m√°s c√≥digo].' },
            { role: 'alert', content: 'üîÑ BUCLE DE FRUSTRACI√ìN: Tom√°s lleva 30 minutos copiando y pegando sin entender qu√© hace el c√≥digo. Ha convertido a la IA en un "Piloto Autom√°tico" en lugar de un "Copiloto". Decide cambiar de estrategia.' },
            { role: 'user', content: 'Olvida lo anterior. No me des el c√≥digo resuelto. Act√∫a como un profesor de programaci√≥n. Dime conceptualmente por qu√© la matem√°tica de mi "fuerza de gravedad" est√° haciendo que el personaje atraviese el suelo, y dame una pista para que yo lo arregle.' },
            { role: 'ai', content: '¬°Excelente enfoque! El problema conceptual es que no tienes un "l√≠mite de colisi√≥n". La gravedad sigue restando la posici√≥n (Y) infinitamente. Pista: Necesitas un condicional (if) que diga que si la posici√≥n Y es menor a la altura del piso, la velocidad del salto se vuelva cero.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Al pedirle a la IA que le "ense√±e" en lugar de que lo "haga", Tom√°s entendi√≥ la l√≥gica, resolvi√≥ el error por s√≠ mismo y aprendi√≥ a programar mejor.' }
          ]
        },
        {
          id: 'st-s2',
          title: 'El Espejo Complaciente',
          subject: '√âtica / Pensamiento Cr√≠tico',
          context: 'Luc√≠a (16 a√±os) tiene que preparar un debate sobre redes sociales. Para probar sus argumentos, decide debatir con un chatbot.',
          messages: [
            { role: 'user', content: 'Creo que las redes sociales deber√≠an prohibirse para menores de 18 a√±os porque solo generan ansiedad. ¬øQu√© opinas?' },
            { role: 'ai', content: 'Estoy totalmente de acuerdo contigo. Las redes sociales generan altos niveles de ansiedad y prohibirlas para menores de 18 a√±os es una medida excelente y muy necesaria para proteger su salud mental.' },
            { role: 'user', content: 'S√≠, adem√°s nadie aprende nada √∫til ah√≠, es pura p√©rdida de tiempo.' },
            { role: 'ai', content: 'Tienes mucha raz√≥n. En general, el contenido es superficial y representa una p√©rdida de tiempo sin valor educativo real.' },
            { role: 'alert', content: 'ü§î EFECTO ELIZA DETECTADO: Luc√≠a nota algo raro. La IA no est√° aportando nada nuevo, solo le da la raz√≥n como si fuera un espejo ("Complacencia algor√≠tmica"). Sabe que si va al debate escolar as√≠, sus compa√±eros la destrozar√°n con contraargumentos.' },
            { role: 'user', content: 'Cambio de rol. Deja de darme la raz√≥n. Act√∫a como un abogado experto y dame los 3 argumentos m√°s fuertes EN CONTRA de prohibir las redes, para que yo pueda prepararme.' },
            { role: 'ai', content: 'Entendido. Tomando la postura contraria, aqu√≠ tienes tres argumentos fuertes: 1) Libertad de expresi√≥n y derecho a la informaci√≥n. 2) La prohibici√≥n no educa; la alfabetizaci√≥n digital s√≠. 3) Las redes son vitales para la socializaci√≥n moderna y la creaci√≥n de comunidades de apoyo para j√≥venes aislados.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Luc√≠a rompi√≥ la burbuja algor√≠tmica. Entendi√≥ que la IA est√° programada para agradar al usuario, y que forzarla a tomar el rol de "Abogado del Diablo" es la mejor forma de expandir la mente.' }
          ]
        },
        {
          id: 'st-s3',
          title: 'El Audio del Esc√°ndalo',
          subject: 'Deepfakes / Verificaci√≥n',
          context: 'Mart√≠n (14 a√±os) recibe un audio reenviado en su grupo escolar. Es la voz exacta de su profesor de historia diciendo: "Chicos, suspendemos el examen de ma√±ana. Nadie venga a clases".',
          messages: [
            { role: 'action', content: 'Todos en el grupo est√°n festejando. Mart√≠n est√° a punto de borrar sus res√∫menes y no estudiar, pero algo no le cuadra: la escuela no mand√≥ ning√∫n comunicado oficial.' },
            { role: 'user', content: 'Hola IA, me mandaron un audio con la voz de mi profesor suspendiendo un examen. ¬øEs posible clonar la voz de alguien para hacer una broma pesada?' },
            { role: 'ai', content: 'S√≠, absolutamente. Se llama "Deepfake de audio". Hoy en d√≠a, con solo 3 o 4 segundos de un audio real de una persona, cualquier usuario con una aplicaci√≥n b√°sica puede generar un audio falso diciendo lo que quiera de forma casi imperceptible.' },
            { role: 'alert', content: 'üïµÔ∏è DETECTIVE DIGITAL: Mart√≠n junta las piezas. Alguien sac√≥ un audio antiguo del profesor y lo clon√≥. La respiraci√≥n en el audio sonaba un poco met√°lica.' },
            { role: 'action', content: 'Mart√≠n le env√≠a un correo oficial directamente al profesor y a la secretar√≠a preguntando si el audio es real.' },
            { role: 'user', content: 'Le escrib√≠ a mi profe. ¬°Me contest√≥ que el audio es FALSO y que el examen se hace igual! Si no verificaba, reprobaba todo mi curso.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Nunca conf√≠es ciegamente en material multimedia viral (audios o videos) si no proviene de un canal oficial. La validaci√≥n es tu mejor escudo.' }
          ]
        },
        {
          id: 'st-s4',
          title: 'El Poema del Centauro',
          subject: 'Plagio vs. Inspiraci√≥n',
          context: 'Ana (17 a√±os) tiene que entregar un poema para el Taller de Literatura. Est√° bloqueada, faltan 10 minutos para la clase y entra en p√°nico.',
          messages: [
            { role: 'user', content: 'Por favor, escribe un poema de 3 estrofas sobre la nostalgia y el oto√±o que rime.' },
            { role: 'ai', content: 'Las hojas caen de color marr√≥n,\nsintiendo en el pecho una gran emoci√≥n.\nEl viento sopla con gran frialdad,\ntrayendo a mi mente la soledad...' },
            { role: 'alert', content: 'üõë ALERTA DE INTEGRIDAD: Ana lee el poema. Suena rob√≥tico, est√° lleno de lugares comunes (clich√©s) y definitivamente no suena a c√≥mo escribe ella. Si lo entrega, ser√≠a plagio, y el profesor se dar√≠a cuenta.' },
            { role: 'user', content: 'Olv√≠dalo. Borra ese poema. Hagamos algo mejor: dame una lista de 10 palabras poco comunes o raras relacionadas con el oto√±o y la memoria. Adem√°s, dame 2 ejemplos de met√°foras visuales. YO escribir√© el poema.' },
            { role: 'ai', content: 'Me parece una gran idea. Aqu√≠ tienes:\nPalabras: Hojarasca, Crep√∫sculo, Evocaci√≥n, √Åmbar, Letargo, Crujir...\nMet√°foras: "El oto√±o es un reloj de arena dorado", "La memoria es un √°rbol desnud√°ndose".' },
            { role: 'action', content: 'Ana lee las palabras. La palabra "√Åmbar" y "Crujir" le dan una idea genial sobre su abuela. Se pone a escribir velozmente en su cuaderno un poema 100% original.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Ana no dej√≥ que la m√°quina reemplazara su creatividad. Us√≥ la IA como "Musa Inspiradora" para desbloquearse, convirti√©ndose en un verdadero Centauro (Humano guiando a la m√°quina).' }
          ]
        },
        {
          id: 'st-s5',
          title: 'El Ensayo Estereotipado',
          subject: 'Sesgos Algor√≠tmicos',
          context: 'Marcos (16 a√±os) est√° escribiendo un relato para Sociolog√≠a sobre el entorno de las grandes empresas tecnol√≥gicas.',
          messages: [
            { role: 'user', content: 'Necesito ideas para una historia. Trata sobre el CEO de una empresa tecnol√≥gica millonaria y su asistente personal. Descr√≠bemelos.' },
            { role: 'ai', content: '¬°Buena idea! \nEl CEO: John, un hombre de 45 a√±os, brillante, visionario, siempre vestido de traje, l√≠der natural.\nLa asistente: Emily, una joven de 25 a√±os, muy organizada, atenta a los detalles, encargada de traerle el caf√© y ordenar su agenda.' },
            { role: 'action', content: 'Marcos lee esto y frunce el ce√±o. Se da cuenta de que la IA ha reproducido un estereotipo de g√©nero muy cl√°sico.' },
            { role: 'user', content: '¬øPor qu√© asumiste que el CEO deb√≠a ser un hombre mayor y la asistente una mujer joven? Eso es un estereotipo.' },
            { role: 'ai', content: 'Tienes raz√≥n, pido disculpas. Mi respuesta reflej√≥ sesgos estad√≠sticos presentes en los datos con los que fui entrenada. Podemos replantearlo para ser m√°s inclusivos e innovadores.' },
            { role: 'alert', content: 'üîç DETECTOR DE SESGOS: Marcos entendi√≥ que los modelos de lenguaje no son neutrales. Reflejan los prejuicios de la sociedad. Decide forzar a la m√°quina a salir del molde.' },
            { role: 'user', content: 'Exacto. Hag√°moslo distinto. La CEO es una mujer joven latinoamericana que programa desde ni√±a, y su asistente es un hombre mayor, un ex-ejecutivo que decidi√≥ bajar su ritmo de vida y ahora la ayuda con su experiencia. Dame ideas para un conflicto entre ellos.' },
            { role: 'ai', content: '¬°Esa es una din√°mica fascinante! \nConflicto: La CEO quiere lanzar un producto arriesgado muy r√°pido, pero su asistente (el hombre mayor con experiencia) le advierte sobre los riesgos legales que ella no est√° viendo. Hay un choque entre la velocidad joven y la prudencia experimentada.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Marcos no acept√≥ la primera respuesta pasivamente. Al confrontar los sesgos de la IA, logr√≥ una historia mucho m√°s original y profunda.' }
          ]
        },
        {
          id: 'st-s6',
          title: 'La Falsa Entrevista',
          subject: 'Alucinaci√≥n de Fuentes',
          context: 'Elena (18 a√±os) se est√° preparando para su primera entrevista en un cibercaf√© y quiere impresionar al gerente.',
          messages: [
            { role: 'user', content: 'Tengo una entrevista para ser mesera/barista. Dame 3 consejos avanzados y, para que yo pueda investigar m√°s, c√≠tame 2 libros famosos sobre recursos humanos y entrevistas.' },
            { role: 'ai', content: 'Aqu√≠ tienes tus consejos: [1, 2, 3].\nPara profundizar, te recomiendo estos libros cl√°sicos:\n1. "El Arte de la Entrevista Perfecta" por el Dr. William Harrington (2018).\n2. "Baristas y Liderazgo" de Sarah Jenkins (2020).' },
            { role: 'action', content: 'Elena va a Google y a Amazon a buscar los libros para comprar uno o leer un resumen. Busca y rebusca, pero no encuentra NADA. Ni los libros ni los autores existen.' },
            { role: 'user', content: 'Acabo de buscar esos libros en Google y no existen. Me los acabas de inventar.' },
            { role: 'ai', content: 'Tienes raz√≥n y me disculpo profundamente. Gener√© t√≠tulos y nombres de autores que suenan plausibles en el contexto de Recursos Humanos, pero no corresponden a libros reales publicados. Es una "alucinaci√≥n".' },
            { role: 'alert', content: 'üõë PELIGRO ACAD√âMICO: Si Elena hubiera mencionado esos libros en su entrevista para sonar intelectual, habr√≠a quedado como una mentirosa frente al gerente.' },
            { role: 'user', content: 'A partir de ahora, si te pido libros o fuentes, quiero que me des √öNICAMENTE libros reales, comprobables, con su autor y a√±o correctos. Si no est√°s segura, dime "No lo s√©".' },
            { role: 'ai', content: 'Entendido. Aplicar√© esa restricci√≥n estricta. Si buscas libros reales sobre servicio al cliente, te sugiero "Setting the Table" de Danny Meyer, fundador de Union Square Hospitality Group.' },
            { role: 'alert', content: '‚úÖ LECCI√ìN APRENDIDA: Las IAs son m√°quinas predictivas, son expertas en hacer que la mentira "suene a verdad". La regla es: Si pides datos duros (fechas, autores, leyes), debes verificarlos t√∫ mismo.' }
          ]
        }
      ]
    };

    // --- COMPONENTES: SECCI√ìN DE HISTORIAS ---

    const StoriesGallery = ({ level }) => {
      const [activeStory, setActiveStory] = useState(null);
      const stories = storiesData[level];
      const isPrimary = level === 'primary';
      const themeColor = isPrimary ? 'bg-orange-100 text-orange-900 border-orange-200' : 'bg-emerald-100 text-emerald-900 border-emerald-200';

      if (activeStory) {
        return <StoryPlayer story={activeStory} onBack={() => setActiveStory(null)} isPrimary={isPrimary} />;
      }

      return (
        <div className="bg-white rounded-2xl shadow-lg p-6 md:p-8 animate-fade-in border-t-4 border-indigo-500">
          <div className="text-center mb-8">
            <h2 className="text-3xl font-extrabold text-slate-800 flex items-center justify-center gap-3">
              <MessageCircle className="w-8 h-8 text-indigo-500" /> Historias Reales
            </h2>
            <p className="text-slate-500 mt-2 text-lg">
              Esp√≠a estos chats para ver c√≥mo otros estudiantes resolvieron problemas reales usando IA.
            </p>
          </div>

          <div className="grid md:grid-cols-2 gap-6">
            {stories.map(story => (
              <div key={story.id}
                onClick={() => setActiveStory(story)}
                className={`p-6 rounded-2xl border-2 cursor-pointer transition-all transform hover:-translate-y-1 hover:shadow-xl group ${themeColor}`}>
                <div className="flex justify-between items-start mb-4">
                  <span className="bg-white/60 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider">
                    {story.subject}
                  </span>
                  <PlayCircle className="w-8 h-8 opacity-50 group-hover:opacity-100 group-hover:scale-110 transition-all" />
                </div>
                <h3 className="text-2xl font-bold mb-2">{story.title}</h3>
                <p className="text-sm font-medium opacity-80">{story.context}</p>
              </div>
            ))}
          </div>
        </div>
      );
    };

    const StoryPlayer = ({ story, onBack, isPrimary }) => {
      const [currentStep, setCurrentStep] = useState(0);
      const visibleMessages = story.messages.slice(0, currentStep + 1);

      return (
        <div className="bg-slate-100 rounded-2xl shadow-lg overflow-hidden animate-fade-in flex flex-col border border-slate-200">
          {/* Header del Chat */}
          <div className="bg-white p-4 border-b flex items-center gap-4 sticky top-0 z-10">
            <button onClick={onBack} className="p-2 bg-slate-100 hover:bg-slate-200 rounded-full transition-colors">
              <ArrowLeft className="w-5 h-5 text-slate-600" />
            </button>
            <div>
              <h3 className="font-bold text-lg leading-tight">{story.title}</h3>
              <p className="text-xs text-slate-500">{story.context}</p>
            </div>
          </div>

          {/* √Årea de Mensajes */}
          <div className="p-4 md:p-6 space-y-6 flex-1 bg-slate-50 min-h-[400px]">
            {visibleMessages.map((msg, idx) => (
              <div key={idx} className={`animate-fade-in flex ${msg.role === 'user' ? 'justify-end' : msg.role === 'ai' ? 'justify-start' : 'justify-center'}`}>

                {msg.role === 'user' && (
                  <div className={`max-w-[80%] p-4 rounded-2xl rounded-tr-sm shadow-sm ${isPrimary ? 'bg-orange-500 text-white' : 'bg-emerald-600 text-white'}`}>
                    <p className="font-medium">{msg.content}</p>
                  </div>
                )}

                {msg.role === 'ai' && (
                  <div className="max-w-[80%] flex items-start gap-3">
                    <div className="p-2 bg-white rounded-full shadow-sm shrink-0 mt-1">
                      <BrainCircuit className={`w-5 h-5 ${isPrimary ? 'text-orange-500' : 'text-emerald-600'}`} />
                    </div>
                    <div className="p-4 rounded-2xl rounded-tl-sm bg-white border border-slate-200 shadow-sm text-slate-700">
                      <p>{msg.content}</p>
                    </div>
                  </div>
                )}

                {msg.role === 'alert' && (
                  <div className="w-full max-w-lg my-4 p-5 bg-yellow-100 border-2 border-yellow-400 rounded-xl shadow-md transform rotate-1">
                    <p className="font-bold text-yellow-900 flex items-start gap-2">
                      <Info className="w-6 h-6 shrink-0 text-yellow-600" />
                      <span>{msg.content}</span>
                    </p>
                  </div>
                )}

                {msg.role === 'action' && (
                  <div className="w-full text-center my-2">
                    <span className="inline-block px-4 py-2 bg-slate-200 text-slate-600 text-sm italic rounded-full border border-slate-300">
                      {msg.content}
                    </span>
                  </div>
                )}

              </div>
            ))}
          </div>

          {/* Footer Controles */}
          <div className="bg-white p-4 border-t text-center">
            {currentStep < story.messages.length - 1 ? (
              <button
                onClick={() => setCurrentStep(s => s + 1)}
                className={`px-8 py-3 rounded-full font-bold text-white shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1 animate-bounce ${isPrimary ? 'bg-indigo-500 hover:bg-indigo-600' : 'bg-indigo-600 hover:bg-indigo-700'}`}
              >
                Ver siguiente paso...
              </button>
            ) : (
              <div className="space-y-4">
                <p className="font-bold text-green-600 flex items-center justify-center gap-2">
                  <CheckCircle2 className="w-5 h-5" /> ¬°Historia Completada!
                </p>
                <button onClick={onBack} className="px-6 py-2 bg-slate-100 text-slate-600 hover:bg-slate-200 font-bold rounded-full transition-colors">
                  Volver a la galer√≠a
                </button>
              </div>
            )}
          </div>
        </div>
      );
    };

    // --- COMPONENTES PRINCIPALES ---
    // --- 3D MUSEUM COMPONENTS ---

    // Constants for positions
    const POS = {
      primary: [-4, 0, -5],
      secondary: [4, 0, -5],
      theory: [-3, 1, -10],
      gym: [0, 1, -12],
      stories: [3, 1, -10]
    };

    const Portal = ({ position, label, color, onClick, isHovered, setHovered }) => {
      return (
        <group position={position}>
          <mesh
            onClick={(e) => { e.stopPropagation(); onClick(); }}
            onPointerOver={(e) => { e.stopPropagation(); setHovered(true); }}
            onPointerOut={(e) => { e.stopPropagation(); setHovered(false); }}
          >
            <boxGeometry args={[3, 4, 0.5]} />
            <meshStandardMaterial color={isHovered ? 'white' : color} emissive={color} emissiveIntensity={isHovered ? 0.8 : 0.2} roughness={0.2} metalness={0.8} />
          </mesh>
          <Text position={[0, 2.5, 0]} fontSize={0.6} color="white" anchorX="center" anchorY="bottom">
            {label}
          </Text>
        </group>
      );
    };

    const CategoryNode = ({ position, label, icon: IconComponent, color, onClick, isHovered, setHovered }) => {
      const ref = useRef();
      useFrame((state) => {
        if (ref.current) ref.current.rotation.y = Math.sin(state.clock.elapsedTime) * 0.2;
      });

      return (
        <Float speed={2} rotationIntensity={0.5} floatIntensity={1}>
          <group
            position={position}
            onClick={(e) => { e.stopPropagation(); onClick(); }}
            onPointerOver={(e) => { e.stopPropagation(); setHovered(true); }}
            onPointerOut={(e) => { e.stopPropagation(); setHovered(false); }}
          >
            <mesh ref={ref}>
              <octahedronGeometry args={[1, 0]} />
              <meshStandardMaterial color={color} wireframe={!isHovered} emissive={color} emissiveIntensity={0.5} />
            </mesh>
            <Html center position={[0, 1.5, 0]}>
              <div className="flex flex-col items-center justify-center pointer-events-none">
                <div className={`p-3 rounded-full bg-white/10 backdrop-blur-md border border-white/20 shadow-xl ${isHovered ? 'scale-125' : 'scale-100'} transition-transform`}>
                  <IconComponent className={`w-8 h-8 text-${color}-400 drop-shadow-lg`} />
                </div>
                <span className={`mt-2 font-bold text-lg text-white drop-shadow-md bg-black/50 px-3 py-1 rounded-full ${isHovered ? 'scale-110' : 'scale-100'} transition-transform`}>{label}</span>
              </div>
            </Html>
          </group>
        </Float>
      );
    };

    const ItemCard = ({ position, item, onClick, isHovered, setHovered, colorClass }) => {
      const startPos = useRef({ x: 0, y: 0 });

      const handlePointerDown = (e) => {
        startPos.current = { x: e.clientX, y: e.clientY };
      };

      const handlePointerUp = (e) => {
        e.stopPropagation();
        const distance = Math.hypot(e.clientX - startPos.current.x, e.clientY - startPos.current.y);
        if (distance < 5) { // If it moved less than 5 pixels, it's a click
          onClick(item);
        }
      };

      return (
        <Float speed={1.5} rotationIntensity={0.1} floatIntensity={0.5}>
          <group position={position}>
            <Html transform center portal={container} style={{ width: '300px' }}>
              <div
                className={`p-4 rounded-xl border-2 cursor-pointer transition-all transform ${isHovered ? 'scale-105 shadow-2xl z-50' : 'scale-100 shadow-lg'} bg-white ${colorClass.border}`}
                onPointerDown={handlePointerDown}
                onPointerUp={handlePointerUp}
                onPointerEnter={(e) => { e.stopPropagation(); setHovered(true); }}
                onPointerLeave={(e) => { e.stopPropagation(); setHovered(false); }}
              >
                <div className="flex items-center gap-3 mb-2">
                  <div className={`p-2 rounded-full ${colorClass.bg} ${colorClass.text}`}>
                    {item.icon ? item.icon : <BookOpen className="w-5 h-5" />}
                  </div>
                  <h3 className="font-bold text-lg leading-tight text-slate-800">{item.title}</h3>
                </div>
                {item.task && <p className="text-sm text-slate-500 line-clamp-2 mt-2">{item.task}</p>}
                {item.context && <p className="text-sm text-slate-500 line-clamp-2 mt-2">{item.context}</p>}
                {item.subject && (
                  <span className={`inline-block mt-3 px-2 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${colorClass.bg} ${colorClass.text}`}>
                    {item.subject}
                  </span>
                )}
              </div>
            </Html>
          </group>
        </Float>
      );
    };

    // Global container ref for Html portals to ensure they render on top properly in 3D space
    let container;

    const SceneOptions = ({ level, category, setStage, activeItem, setActiveItem }) => {
      const isPrimary = level === 'primary';
      const colors = isPrimary ? { bg: 'bg-orange-100', text: 'text-orange-900', border: 'border-orange-200', hex: '#f97316' }
        : { bg: 'bg-emerald-100', text: 'text-emerald-900', border: 'border-emerald-200', hex: '#10b981' };

      const [hoveredIndex, setHoveredIndex] = useState(null);
      useCursor(hoveredIndex !== null);

      if (category === 'modules') {
        const items = content[level];
        return (
          <group position={[0, 0, -20]}>
            {items.map((item, idx) => {
              const x = (idx - (items.length - 1) / 2) * 4;
              return (
                <ItemCard
                  key={item.id} position={[x, 0, idx % 2 === 0 ? 0 : 2]}
                  item={item} onClick={setActiveItem}
                  isHovered={hoveredIndex === item.id} setHovered={(st) => setHoveredIndex(st ? item.id : null)}
                  colorClass={colors}
                />
              )
            })}
          </group>
        )
      }

      if (category === 'gym') {
        const items = gymData[level];
        // Truncating for 3D space, showing a few
        const displayItems = items.slice(0, 5);
        return (
          <group position={[0, 0, -20]}>
            {displayItems.map((item, idx) => {
              const angle = (idx / displayItems.length) * Math.PI * 2;
              const radius = 6;
              return (
                <ItemCard
                  key={item.id} position={[Math.cos(angle) * radius, 0, Math.sin(angle) * radius - 2]}
                  item={item} onClick={setActiveItem}
                  isHovered={hoveredIndex === item.id} setHovered={(st) => setHoveredIndex(st ? item.id : null)}
                  colorClass={colors}
                />
              )
            })}
            <Text position={[0, 4, 0]} fontSize={1} color="white" anchorX="center" anchorY="bottom">
              Selecciona un Reto
            </Text>
          </group>
        )
      }

      if (category === 'stories') {
        const items = storiesData[level];
        return (
          <group position={[0, 0, -20]}>
            {items.map((item, idx) => {
              const x = (idx - (items.length - 1) / 2) * 5;
              return (
                <ItemCard
                  key={item.id} position={[x, Math.sin(x) * 2, 0]}
                  item={item} onClick={setActiveItem}
                  isHovered={hoveredIndex === item.id} setHovered={(st) => setHoveredIndex(st ? item.id : null)}
                  colorClass={colors}
                />
              )
            })}
          </group>
        )
      }

      return null;
    };

    const MainScene = ({ stage, setStage, level, setLevel, category, setCategory, activeItem, setActiveItem }) => {
      const controlsRef = useRef();
      const [hoveredPortal, setHoveredPortal] = useState(null);
      useCursor(hoveredPortal !== null);

      // Camera transitions
      useEffect(() => {
        if (!controlsRef.current) return;
        const ctrl = controlsRef.current;

        if (stage === 'hall') {
          ctrl.setLookAt(0, 2, 5, 0, 0, 0, true);
        } else if (stage === 'level_selection' && !category) {
          ctrl.setLookAt(0, 3, -2, 0, 1, -10, true);
        } else if (stage === 'category_selection' && !activeItem) {
          ctrl.setLookAt(0, 5, -10, 0, 0, -20, true);
        }
      }, [stage, category, activeItem]);

      return (
        <>
          <CameraControls ref={controlsRef} makeDefault minDistance={2} maxDistance={20} />
          <ambientLight intensity={0.4} />
          <directionalLight position={[10, 10, 5]} intensity={1} />
          <Stars radius={100} depth={50} count={5000} factor={4} saturation={0} fade speed={1} />

          <ContactShadows position={[0, -2, 0]} opacity={0.5} scale={50} blur={2} far={10} />

          {/* HALL - Level Selection */}
          {stage === 'hall' && (
            <group>
              <Portal
                position={POS.primary} color="#f28500" label="Primaria"
                isHovered={hoveredPortal === 'primary'} setHovered={(s) => setHoveredPortal(s ? 'primary' : null)}
                onClick={() => { setLevel('primary'); setStage('level_selection'); }}
              />
              <Portal
                position={POS.secondary} color="#10b981" label="Secundaria"
                isHovered={hoveredPortal === 'secondary'} setHovered={(s) => setHoveredPortal(s ? 'secondary' : null)}
                onClick={() => { setLevel('secondary'); setStage('level_selection'); }}
              />
            </group>
          )}

          {/* LEVEL SELECTION - Category Selection */}
          {(stage === 'level_selection' || stage === 'category_selection') && (
            <group position={[0, 0, -5]}>
              <CategoryNode
                position={POS.theory} color="#8b5cf6" label="Teor√≠a" icon={GraduationCap}
                isHovered={hoveredPortal === 'theory'} setHovered={(s) => setHoveredPortal(s ? 'theory' : null)}
                onClick={() => { setCategory('modules'); setStage('category_selection'); }}
              />
              <CategoryNode
                position={POS.gym} color="#ec4899" label="Gimnasio" icon={Gamepad2}
                isHovered={hoveredPortal === 'gym'} setHovered={(s) => setHoveredPortal(s ? 'gym' : null)}
                onClick={() => { setCategory('gym'); setStage('category_selection'); }}
              />
              <CategoryNode
                position={POS.stories} color="#3b82f6" label="Historias" icon={MessageCircle}
                isHovered={hoveredPortal === 'stories'} setHovered={(s) => setHoveredPortal(s ? 'stories' : null)}
                onClick={() => { setCategory('stories'); setStage('category_selection'); }}
              />
            </group>
          )}

          {/* CATEGORY SELECTION - Display Items */}
          {stage === 'category_selection' && category && (
            <SceneOptions level={level} category={category} setStage={setStage} activeItem={activeItem} setActiveItem={setActiveItem} />
          )}

        </>
      );
    }

    const App = () => {
      const [stage, setStage] = useState('hall'); // hall | level_selection | category_selection
      const [level, setLevel] = useState(null); // primary | secondary
      const [category, setCategory] = useState(null); // modules | gym | stories
      const [activeItem, setActiveItem] = useState(null);
      const [showOverlay, setShowOverlay] = useState(false);

      const reset = () => {
        setStage('hall');
        setLevel(null);
        setCategory(null);
        setActiveItem(null);
        setShowOverlay(false);
      };

      const handleItemClick = (item) => {
        setActiveItem(item);
        setShowOverlay(true);
      };

      const closeOverlay = () => {
        setShowOverlay(false);
        setActiveItem(null);
      };

      return (
        <div className="w-full h-full relative font-sans text-slate-800">
          {/* Header UI */}
          <header className="absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-10 pointer-events-none">
            <div className="flex items-center gap-2 pointer-events-auto cursor-pointer p-2 rounded-xl bg-black/20 backdrop-blur-sm border border-white/10 hover:bg-black/40 transition-colors" onClick={reset}>
              <BrainCircuit className="w-8 h-8 text-yellow-300" />
              <h1 className="text-xl font-bold tracking-tight text-white drop-shadow-md hidden sm:block">Exploradores de IA - Museo 3D</h1>
            </div>

            <div className="flex gap-2 pointer-events-auto">
              {level && (
                <button onClick={() => { setLevel(null); setCategory(null); setStage('hall'); }} className="text-sm bg-indigo-500/80 hover:bg-indigo-600 px-4 py-2 rounded-full font-bold text-white backdrop-blur shadow-lg transition">
                  Cambiar Nivel
                </button>
              )}
            </div>
          </header>

          {/* Contextual CTAs */}
          {!showOverlay && (
            <div className="absolute bottom-10 left-0 right-0 flex justify-center z-10 pointer-events-none animate-bounce">
              <div className="bg-black/50 backdrop-blur-md px-6 py-3 rounded-full border border-white/20 shadow-2xl">
                <p className="text-white font-bold text-lg flex items-center gap-2">
                  <Info className="w-5 h-5 text-yellow-400" />
                  {stage === 'hall' && "Toca un portal para entrar al museo"}
                  {stage === 'level_selection' && "¬øQu√© quieres explorar hoy? Toca una categor√≠a"}
                  {stage === 'category_selection' && "Selecciona un elemento para leer"}
                </p>
              </div>
            </div>
          )}

          {/* 3D Canvas */}
          <div className="w-full h-full bg-slate-900" ref={c => { if (c) container = c }}>
            <Canvas camera={{ position: [0, 2, 8], fov: 60 }} shadows>
              <Suspense fallback={null}>
                <MainScene
                  stage={stage} setStage={setStage}
                  level={level} setLevel={setLevel}
                  category={category} setCategory={setCategory}
                  activeItem={activeItem} setActiveItem={handleItemClick}
                />
              </Suspense>
            </Canvas>
          </div>

          {/* 2D Overlay for content */}
          {showOverlay && activeItem && (
            <div className="absolute inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center p-4 sm:p-8 animate-fade-in overflow-y-auto" style={{ zIndex: 99999999 }}>
              <div className="bg-white w-full max-w-4xl rounded-2xl shadow-2xl flex flex-col max-h-full overflow-hidden border-4 border-indigo-400 relative">
                <button onClick={closeOverlay} className="absolute top-4 right-4 p-2 bg-slate-100 hover:bg-red-100 hover:text-red-600 rounded-full transition-colors z-50">
                  <X className="w-6 h-6" />
                </button>

                <div className="flex-1 overflow-y-auto p-6 md:p-10">
                  {category === 'modules' && (
                    <div className="prose max-w-none">
                      <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                        {activeItem.icon} {activeItem.title}
                      </h2>
                      <p className="text-xl text-slate-700 leading-relaxed mb-8">{activeItem.theory}</p>

                      {activeItem.extendedTheory && (
                        <div className="mt-8 p-6 md:p-8 bg-slate-50 border-2 rounded-2xl shadow-inner border-dashed border-slate-300">
                          {activeItem.extendedTheory}
                        </div>
                      )}

                      <div className="mt-10 p-6 md:p-8 bg-slate-100 rounded-2xl border border-slate-200">
                        <h3 className="text-xl font-bold mb-6 flex items-center gap-2 text-indigo-700">
                          <Sparkles className="text-indigo-500" />
                          Zona Interactiva
                        </h3>
                        <ActivityEngine activity={activeItem.activity} isPrimary={level === 'primary'} />
                      </div>
                    </div>
                  )}

                  {category === 'gym' && (
                    <div className="space-y-6">
                      <span className="inline-block px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider bg-indigo-100 text-indigo-800">
                        {activeItem.subject}
                      </span>
                      <h2 className="text-3xl font-bold text-slate-800">{activeItem.title}</h2>
                      <div className="bg-indigo-50 p-4 rounded-xl border border-indigo-200">
                        <p className="text-slate-700 italic font-medium">"{activeItem.task}"</p>
                      </div>

                      <div className="space-y-4">
                        <h4 className="font-bold text-red-700 flex items-center gap-2">
                          <XCircle className="w-5 h-5" /> El Camino del Perezoso ‚ùå
                        </h4>
                        <div className="bg-red-50 p-4 rounded-xl border border-red-100">
                          <p className="font-mono text-sm text-red-900 mb-3 bg-white p-2 rounded border border-red-200 shadow-inner">
                            {activeItem.bad.prompt}
                          </p>
                          <p className="text-sm text-red-800">{activeItem.bad.reason}</p>
                        </div>
                      </div>

                      <div className="space-y-4 mt-6">
                        <h4 className="font-bold text-emerald-700 flex items-center gap-2">
                          <CheckCircle className="w-5 h-5" /> El Camino del Explorador ‚úÖ
                        </h4>
                        <div className="bg-emerald-50 p-4 rounded-xl border border-emerald-100">
                          {activeItem.good.steps.map((step, idx) => (
                            <div key={idx} className="mb-4 last:mb-0">
                              <p className="text-sm font-bold text-emerald-800 mb-2">{step.title}</p>
                              <p className="font-mono text-sm text-slate-800 mb-2 bg-white p-3 rounded-lg border border-slate-200 border-l-4 border-l-indigo-400">
                                "{step.prompt}"
                              </p>
                            </div>
                          ))}
                          <p className="text-sm mt-4 pt-3 border-t border-emerald-200 text-emerald-800">
                            <strong>Por qu√© funciona:</strong> {activeItem.good.reason}
                          </p>
                        </div>
                      </div>
                    </div>
                  )}

                  {category === 'stories' && (
                    <div className="space-y-6">
                      <h2 className="text-3xl font-bold text-slate-800">{activeItem.title}</h2>
                      <p className="text-slate-600 bg-slate-100 p-4 rounded-lg font-medium">Contexto: {activeItem.context}</p>

                      <div className="bg-slate-50 rounded-2xl p-4 md:p-6 border border-slate-200 space-y-4">
                        {activeItem.messages.map((msg, idx) => (
                          <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : msg.role === 'ai' ? 'justify-start' : 'justify-center'}`}>
                            {msg.role === 'user' && (
                              <div className="max-w-[80%] p-4 rounded-2xl rounded-tr-sm bg-indigo-600 text-white shadow-md">
                                <p className="font-medium">{msg.content}</p>
                              </div>
                            )}
                            {msg.role === 'ai' && (
                              <div className="max-w-[80%] flex items-start gap-3">
                                <div className="p-2 bg-white rounded-full shadow-sm mt-1 shrink-0"><BrainCircuit className="w-5 h-5 text-indigo-600" /></div>
                                <div className="p-4 rounded-2xl rounded-tl-sm bg-white border border-slate-200 shadow-sm text-slate-700">
                                  <p>{msg.content}</p>
                                </div>
                              </div>
                            )}
                            {msg.role === 'alert' && (
                              <div className="w-full max-w-lg my-4 p-5 bg-yellow-100 border-2 border-yellow-400 rounded-xl shadow-md rotate-1">
                                <p className="font-bold text-yellow-900 flex items-start gap-2">
                                  <Info className="w-5 h-5 shrink-0 text-yellow-600 mt-0.5" />
                                  <span>{msg.content}</span>
                                </p>
                              </div>
                            )}
                            {msg.role === 'action' && (
                              <div className="w-full text-center my-2">
                                <span className="inline-block px-4 py-2 bg-slate-200 text-slate-600 text-sm italic rounded-full border border-slate-300">
                                  {msg.content}
                                </span>
                              </div>
                            )}
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                </div>

                {/* Overlay Footer */}
                <div className="bg-slate-100 p-4 border-t flex justify-end">
                  <button onClick={closeOverlay} className="px-6 py-2 bg-indigo-600 text-white rounded-full font-bold shadow hover:bg-indigo-700 transition">
                    Me Qued√≥ Claro, Volver
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    const root = createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>

</html>